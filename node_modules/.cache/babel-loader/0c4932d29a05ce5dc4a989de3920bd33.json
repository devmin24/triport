{"ast":null,"code":"import{createSlice}from\"@reduxjs/toolkit\";import{config}from\"./config\";import Swal from\"sweetalert2\";var profileimgSlice=createSlice({name:\"profile\",initialState:{user_img:\"\",memberGrade:null,nickname:null,mypost_trils_data:[],mypost_trilog_data:[],like_trils_data:[],like_trilog_data:[]},reducers:{SET_PREVIEW:function SET_PREVIEW(state,action){state.user_img=action.payload;},GET_PROFILE:function GET_PROFILE(state,action){state.user_img=action.payload.user_img;state.memberGrade=action.payload.memberGrade;state.nickname=action.payload.nickname;},EDIT_PROFILE:function EDIT_PROFILE(state,action){state.nickname=action.payload.nickname;state.user_img=action.payload.img;state.memberGrade=state.memberGrade;state.newpwd=action.payload.newpwd;state.newpwdcheck=action.payload.newpwdcheck;},UPDATE_PROFILE:function UPDATE_PROFILE(state,action){state.uploading=action.payload;},POST_TRILS_LOAD:function POST_TRILS_LOAD(state,action){state.mypost_trils_data=action.payload;},POST_TRILOG_LOAD:function POST_TRILOG_LOAD(state,action){state.mypost_trilog_data=action.payload;},LIKE_TRILS_LOAD:function LIKE_TRILS_LOAD(state,action){state.like_trils_data=action.payload;},LIKE_TRILOG_LOAD:function LIKE_TRILOG_LOAD(state,action){state.like_trilog_data=action.payload;}}});// 프로필 조회\nvar getProfile=function getProfile(){return function(dispatch,getState,_ref){var history=_ref.history;var API=\"\".concat(config,\"/member/profile\");var access_token=localStorage.getItem(\"access_token\");fetch(API,{method:\"GET\",// 헤더에 토큰 담아 보내기\nheaders:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"\".concat(access_token)}}).then(function(res){return res.json();}).then(function(data){dispatch(GET_PROFILE({user_img:data.results.profileImgUrl,memberGrade:data.results.memberGrade,nickname:data.results.nickname}));}).catch(function(err){console.log(err);});};};// 프로필 수정 - 이미지 수정\nvar updateProfileImage=function updateProfileImage(img){return function(dispatch,getState,_ref2){var history=_ref2.history;var access_token=localStorage.getItem(\"access_token\");// formdata에 담기\nvar formData=new FormData();formData.append(\"profileImgFile\",img);var api=\"\".concat(config,\"/member/profile/img\");fetch(api,{method:\"POST\",headers:{Authorization:\"\".concat(access_token)},body:formData}).then(function(res){return res.json();}).then(function(data){// console.log(data);\nif(data.status===200){var obj={img:img};dispatch(EDIT_PROFILE(obj));Swal.fire({title:data.msg,icon:\"success\"});window.location.reload();}else{Swal.fire({title:data.msg,icon:\"warning\"});}}).catch(function(err){console.log(err);});};};// 프로필 수정 - 닉네임, 비밀번호 변경\nvar updateProfile=function updateProfile(nickname,newpwd,newpwdcheck){return function(dispatch,getState,_ref3){var history=_ref3.history;var access_token=localStorage.getItem(\"access_token\");var api=\"\".concat(config,\"/member/profile/info\");fetch(api,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"\".concat(access_token)},body:JSON.stringify({nickname:nickname,newPassword:newpwd,newPasswordCheck:newpwdcheck})}).then(function(res){return res.json();}).then(function(data){console.log(data);if(data.status===200){var obj={nickname:nickname,newpwd:newpwd,newpwdcheck:newpwdcheck};dispatch(EDIT_PROFILE(obj));Swal.fire({title:data.msg,icon:\"success\"});// window.location.reload();\n}else{Swal.fire({title:data.msg,icon:\"warning\"});}}).catch(function(err){console.log(err);});};};// 내가 쓴 Trils 조회\nvar myTrilsLoad=function myTrilsLoad(){return function(dispatch,getState,_ref4){var history=_ref4.history;var access_token=localStorage.getItem(\"access_token\");var API=\"\".concat(config,\"/api/posts/member\");fetch(API,{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"\".concat(access_token)}}).then(function(res){return res.json();}).then(function(data){var results=data.results;dispatch(POST_TRILS_LOAD(results));}).catch(function(err){console.log(err);});};};// 내가 쓴 Trilog 조회\nvar myTrilogLoad=function myTrilogLoad(){return function(dispatch,getState,_ref5){var history=_ref5.history;var access_token=localStorage.getItem(\"access_token\");var API=\"\".concat(config,\"/api/boards/member\");fetch(API,{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"\".concat(access_token)}}).then(function(res){return res.json();}).then(function(data){var results=data.results;dispatch(POST_TRILOG_LOAD(results));}).catch(function(err){console.log(err);});};};// 좋아요 Trils 조회\nvar likeTrilsLoad=function likeTrilsLoad(){return function(dispatch,getState,_ref6){var history=_ref6.history;var access_token=localStorage.getItem(\"access_token\");var API=\"\".concat(config,\"/api/posts/member/like\");fetch(API,{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"\".concat(access_token)}}).then(function(res){return res.json();}).then(function(data){var results=data.results;dispatch(LIKE_TRILS_LOAD(results));}).catch(function(err){console.log(err);});};};// 좋아요 Trilog 조회\nvar likeTrilogLoad=function likeTrilogLoad(){return function(dispatch,getState,_ref7){var history=_ref7.history;var access_token=localStorage.getItem(\"access_token\");var API=\"\".concat(config,\"/api/boards/member/like\");fetch(API,{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"\".concat(access_token)}}).then(function(res){return res.json();}).then(function(data){var results=data.results;dispatch(LIKE_TRILOG_LOAD(results));}).catch(function(err){console.log(err);});};};var _profileimgSlice$acti=profileimgSlice.actions,SET_PREVIEW=_profileimgSlice$acti.SET_PREVIEW,GET_PROFILE=_profileimgSlice$acti.GET_PROFILE,EDIT_PROFILE=_profileimgSlice$acti.EDIT_PROFILE,UPDATE_PROFILE=_profileimgSlice$acti.UPDATE_PROFILE,POST_TRILS_LOAD=_profileimgSlice$acti.POST_TRILS_LOAD,POST_TRILOG_LOAD=_profileimgSlice$acti.POST_TRILOG_LOAD,LIKE_TRILS_LOAD=_profileimgSlice$acti.LIKE_TRILS_LOAD,LIKE_TRILOG_LOAD=_profileimgSlice$acti.LIKE_TRILOG_LOAD;export{SET_PREVIEW,GET_PROFILE,EDIT_PROFILE,UPDATE_PROFILE,POST_TRILS_LOAD,POST_TRILOG_LOAD,LIKE_TRILS_LOAD,LIKE_TRILOG_LOAD};export var actionCreators={getProfile:getProfile,updateProfile:updateProfile,myTrilsLoad:myTrilsLoad,myTrilogLoad:myTrilogLoad,likeTrilsLoad:likeTrilsLoad,likeTrilogLoad:likeTrilogLoad,updateProfileImage:updateProfileImage,GET_PROFILE:GET_PROFILE};export default profileimgSlice.reducer;","map":{"version":3,"sources":["/Users/parkminkyung/Desktop/git/triport/src/redux/modules/profile.js"],"names":["createSlice","config","Swal","profileimgSlice","name","initialState","user_img","memberGrade","nickname","mypost_trils_data","mypost_trilog_data","like_trils_data","like_trilog_data","reducers","SET_PREVIEW","state","action","payload","GET_PROFILE","EDIT_PROFILE","img","newpwd","newpwdcheck","UPDATE_PROFILE","uploading","POST_TRILS_LOAD","POST_TRILOG_LOAD","LIKE_TRILS_LOAD","LIKE_TRILOG_LOAD","getProfile","dispatch","getState","history","API","access_token","localStorage","getItem","fetch","method","headers","Accept","Authorization","then","res","json","data","results","profileImgUrl","catch","err","console","log","updateProfileImage","formData","FormData","append","api","body","status","obj","fire","title","msg","icon","window","location","reload","updateProfile","JSON","stringify","newPassword","newPasswordCheck","myTrilsLoad","myTrilogLoad","likeTrilsLoad","likeTrilogLoad","actions","actionCreators","reducer"],"mappings":"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","sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nimport { config } from \"./config\";\nimport Swal from \"sweetalert2\";\n\nconst profileimgSlice = createSlice({\n  name: \"profile\",\n  initialState: {\n    user_img: \"\",\n    memberGrade: null,\n    nickname: null,\n    mypost_trils_data: [],\n    mypost_trilog_data: [],\n    like_trils_data: [],\n    like_trilog_data: [],\n  },\n  reducers: {\n    SET_PREVIEW: (state, action) => {\n      state.user_img = action.payload;\n    },\n    GET_PROFILE: (state, action) => {\n      state.user_img = action.payload.user_img;\n      state.memberGrade = action.payload.memberGrade;\n      state.nickname = action.payload.nickname;\n    },\n    EDIT_PROFILE: (state, action) => {\n      state.nickname = action.payload.nickname;\n      state.user_img = action.payload.img;\n      state.memberGrade = state.memberGrade;\n      state.newpwd = action.payload.newpwd;\n      state.newpwdcheck = action.payload.newpwdcheck;\n    },\n    UPDATE_PROFILE: (state, action) => {\n      state.uploading = action.payload;\n    },\n    POST_TRILS_LOAD: (state, action) => {\n      state.mypost_trils_data = action.payload;\n    },\n    POST_TRILOG_LOAD: (state, action) => {\n      state.mypost_trilog_data = action.payload;\n    },\n    LIKE_TRILS_LOAD: (state, action) => {\n      state.like_trils_data = action.payload;\n    },\n    LIKE_TRILOG_LOAD: (state, action) => {\n      state.like_trilog_data = action.payload;\n    },\n  },\n});\n\n// 프로필 조회\nconst getProfile = () => {\n  return function (dispatch, getState, { history }) {\n    const API = `${config}/member/profile`;\n    let access_token = localStorage.getItem(\"access_token\");\n\n    fetch(API, {\n      method: \"GET\",\n\n      // 헤더에 토큰 담아 보내기\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `${access_token}`,\n      },\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        dispatch(\n          GET_PROFILE({\n            user_img: data.results.profileImgUrl,\n            memberGrade: data.results.memberGrade,\n            nickname: data.results.nickname,\n          })\n        );\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n// 프로필 수정 - 이미지 수정\nconst updateProfileImage = (img) => {\n  return function (dispatch, getState, { history }) {\n    const access_token = localStorage.getItem(\"access_token\");\n\n    // formdata에 담기\n    const formData = new FormData();\n    formData.append(\"profileImgFile\", img);\n\n    const api = `${config}/member/profile/img`;\n\n    fetch(api, {\n      method: \"POST\",\n      headers: {\n        Authorization: `${access_token}`,\n      },\n      body: formData,\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        // console.log(data);\n        if (data.status === 200) {\n          const obj = {\n            img: img,\n          };\n          dispatch(EDIT_PROFILE(obj));\n          Swal.fire({\n            title: data.msg,\n            icon: \"success\",\n          });\n          window.location.reload();\n        } else {\n          Swal.fire({\n            title: data.msg,\n            icon: \"warning\",\n          });\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\n// 프로필 수정 - 닉네임, 비밀번호 변경\nconst updateProfile = (nickname, newpwd, newpwdcheck) => {\n  return function (dispatch, getState, { history }) {\n    const access_token = localStorage.getItem(\"access_token\");\n\n    const api = `${config}/member/profile/info`;\n\n    fetch(api, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `${access_token}`,\n      },\n      body: JSON.stringify({\n        nickname: nickname,\n        newPassword: newpwd,\n        newPasswordCheck: newpwdcheck,\n      }),\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        console.log(data);\n        if (data.status === 200) {\n          const obj = {\n            nickname: nickname,\n            newpwd: newpwd,\n            newpwdcheck: newpwdcheck,\n          };\n          dispatch(EDIT_PROFILE(obj));\n          Swal.fire({\n            title: data.msg,\n            icon: \"success\",\n          });\n          // window.location.reload();\n        } else {\n          Swal.fire({\n            title: data.msg,\n            icon: \"warning\",\n          });\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\n// 내가 쓴 Trils 조회\nconst myTrilsLoad = () => {\n  return function (dispatch, getState, { history }) {\n    let access_token = localStorage.getItem(\"access_token\");\n    const API = `${config}/api/posts/member`;\n\n    fetch(API, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `${access_token}`,\n      },\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        const results = data.results;\n        dispatch(POST_TRILS_LOAD(results));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\n// 내가 쓴 Trilog 조회\nconst myTrilogLoad = () => {\n  return function (dispatch, getState, { history }) {\n    let access_token = localStorage.getItem(\"access_token\");\n    const API = `${config}/api/boards/member`;\n\n    fetch(API, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `${access_token}`,\n      },\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        const results = data.results;\n        dispatch(POST_TRILOG_LOAD(results));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\n// 좋아요 Trils 조회\nconst likeTrilsLoad = () => {\n  return function (dispatch, getState, { history }) {\n    let access_token = localStorage.getItem(\"access_token\");\n    const API = `${config}/api/posts/member/like`;\n\n    fetch(API, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `${access_token}`,\n      },\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        const results = data.results;\n        dispatch(LIKE_TRILS_LOAD(results));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\n// 좋아요 Trilog 조회\nconst likeTrilogLoad = () => {\n  return function (dispatch, getState, { history }) {\n    let access_token = localStorage.getItem(\"access_token\");\n    const API = `${config}/api/boards/member/like`;\n\n    fetch(API, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `${access_token}`,\n      },\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        const results = data.results;\n        dispatch(LIKE_TRILOG_LOAD(results));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\nexport const {\n  SET_PREVIEW,\n  GET_PROFILE,\n  EDIT_PROFILE,\n  UPDATE_PROFILE,\n  POST_TRILS_LOAD,\n  POST_TRILOG_LOAD,\n  LIKE_TRILS_LOAD,\n  LIKE_TRILOG_LOAD,\n} = profileimgSlice.actions;\n\nexport const actionCreators = {\n  getProfile,\n  updateProfile,\n  myTrilsLoad,\n  myTrilogLoad,\n  likeTrilsLoad,\n  likeTrilogLoad,\n  updateProfileImage,\n  GET_PROFILE,\n};\n\nexport default profileimgSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}