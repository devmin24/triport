{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport { produce } from \"immer\"; // http://13.209.8.146\n\nconst userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    email: \"\",\n    password: \"\",\n    ok: true\n  },\n  reducers: {\n    SET_USER: (state, action) => produce(state, draft => {\n      state.user = action.payload;\n    })\n  }\n}); // 로그인 여부 체크\n\nconst loginCheckDB = () => {\n  return function (dispatch, getState, {\n    history\n  }) {\n    const one_user = {\n      email: \"\",\n      password: \"\"\n    };\n    dispatch(SET_USER(one_user));\n  };\n}; // 회원가입\n\n\nconst signupDB = (email, pwd, pwdcheck, nickname) => {\n  return function (dispatch, getState, {\n    history\n  }) {\n    const API = \"http://13.209.8.146/auth/signup\";\n    fetch(API, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      },\n      body: JSON.stringify({\n        email: email,\n        password: pwd,\n        passwordCheck: pwdcheck,\n        nickname: nickname\n      })\n    }).then(() => {\n      console.log(\"회원가입 성공\");\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\n\nconst loginDB = (email, pwd) => {\n  return function (dispatch, getState, {\n    history\n  }) {\n    const API = \"http://13.209.8.146/auth/signup\";\n    fetch(API, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      },\n      body: JSON.stringify({\n        email: email,\n        password: pwd\n      })\n    }).then(result => {\n      //성공시 토큰, 유저 정보 저장\n      if (result.status === 200) {\n        let access_token = result.headers.get(\"Access-Token\");\n        let refresh_token = result.headers.get(\"Refresh-Token\");\n        localStorage.setItem(\"token\", access_token);\n        localStorage.setItem(\"refresh_token\", refresh_token);\n      }\n\n      return result.json();\n    }).then(result => {\n      //성공시 state.user 저장\n      if (result.status === 401) {\n        window.alert(\"로그인에 실패했습니다.\");\n      } else {\n        localStorage.setItem(\"userInfo\", JSON.stringify(result));\n        dispatch(setUser({\n          uid: result.u_id,\n          name: result.name\n        }));\n        history.push(\"/\");\n      }\n    }).catch(error => {\n      console.log(error);\n    });\n  };\n};\n\nconst actionCreators = {\n  loginCheckDB,\n  signupDB\n};\nexport const {\n  SET_USER\n} = userSlice.actions;\nexport default userSlice.reducer;\nexport { actionCreators };","map":{"version":3,"sources":["/Users/parkminkyung/Desktop/git/triport/src/redux/modules/user.js"],"names":["createSlice","produce","userSlice","name","initialState","email","password","ok","reducers","SET_USER","state","action","draft","user","payload","loginCheckDB","dispatch","getState","history","one_user","signupDB","pwd","pwdcheck","nickname","API","fetch","method","headers","Accept","body","JSON","stringify","passwordCheck","then","console","log","catch","err","loginDB","result","status","access_token","get","refresh_token","localStorage","setItem","json","window","alert","setUser","uid","u_id","push","error","actionCreators","actions","reducer"],"mappings":"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","sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nimport { produce } from \"immer\";\n\n// http://13.209.8.146\n\nconst userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    email: \"\",\n    password: \"\",\n    ok: true,\n  },\n  reducers: {\n    SET_USER: (state, action) =>\n      produce(state, (draft) => {\n        state.user = action.payload;\n      }),\n  },\n});\n\n// 로그인 여부 체크\nconst loginCheckDB = () => {\n  return function (dispatch, getState, { history }) {\n    const one_user = {\n      email: \"\",\n      password: \"\",\n    };\n    dispatch(SET_USER(one_user));\n  };\n};\n\n// 회원가입\nconst signupDB = (email, pwd, pwdcheck, nickname) => {\n  return function (dispatch, getState, { history }) {\n    const API = \"http://13.209.8.146/auth/signup\";\n    fetch(API, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n      },\n      body: JSON.stringify({\n        email: email,\n        password: pwd,\n        passwordCheck: pwdcheck,\n        nickname: nickname,\n      }),\n    })\n      .then(() => {\n        console.log(\"회원가입 성공\");\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\nconst loginDB = (email, pwd) => {\n  return function (dispatch, getState, { history }) {\n    const API = \"http://13.209.8.146/auth/signup\";\n    fetch(API, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n      },\n      body: JSON.stringify({\n        email: email,\n        password: pwd,\n      }),\n    })\n      .then((result) => {\n        //성공시 토큰, 유저 정보 저장\n        if (result.status === 200) {\n          let access_token = result.headers.get(\"Access-Token\");\n          let refresh_token = result.headers.get(\"Refresh-Token\");\n\n          localStorage.setItem(\"token\", access_token);\n          localStorage.setItem(\"refresh_token\", refresh_token);\n        }\n        return result.json();\n      })\n      .then((result) => {\n        //성공시 state.user 저장\n        if (result.status === 401) {\n          window.alert(\"로그인에 실패했습니다.\");\n        } else {\n          localStorage.setItem(\"userInfo\", JSON.stringify(result));\n          dispatch(\n            setUser({\n              uid: result.u_id,\n              name: result.name,\n            })\n          );\n          history.push(\"/\");\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n};\n\nconst actionCreators = {\n  loginCheckDB,\n  signupDB,\n};\n\nexport const { SET_USER } = userSlice.actions;\nexport default userSlice.reducer;\n\nexport { actionCreators };\n"]},"metadata":{},"sourceType":"module"}