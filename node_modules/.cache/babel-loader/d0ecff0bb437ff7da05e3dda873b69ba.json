{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/parkminkyung/Desktop/git/triport/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _toConsumableArray from\"/Users/parkminkyung/Desktop/git/triport/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/parkminkyung/Desktop/git/triport/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15;import React from\"react\";import styled from\"styled-components\";import{CommentLike}from\"media/svg/Svg\";import{history}from\"redux/configureStore\";import{BoardChildComment}from\"components/components\";import{actionCreators as TrilogActions}from'redux/modules/trilog';import{useDispatch,useSelector}from'react-redux';import{config}from\"redux/modules/config\";import Swal from\"sweetalert2\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var BoardComment=function BoardComment(props){var dispatch=useDispatch();var is_login=useSelector(function(state){return state.user.is_login;});// 로그인 체크 여부\nvar comment=props.comment;// BoardDetail 컴포넌트로부터 받은 data\nvar commentRef=React.useRef();// 부모 댓글 추가 시 가져오는 내용\nvar _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),showReply=_React$useState2[0],setShowReply=_React$useState2[1];// 대댓글(자식 댓글) 보여주기 토글\nvar _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),showReplyInput=_React$useState4[0],setShowReplyInput=_React$useState4[1];// 답글 작성 토글\nvar _React$useState5=React.useState([]),_React$useState6=_slicedToArray(_React$useState5,2),data=_React$useState6[0],setData=_React$useState6[1];// 대댓글(자식 댓글) 정보\nvar _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),edit=_React$useState8[0],setEdit=_React$useState8[1];// 부모 댓글 수정\nvar _React$useState9=React.useState(''),_React$useState10=_slicedToArray(_React$useState9,2),parentCommentEdit=_React$useState10[0],setParentCommentEdit=_React$useState10[1];// Edit일때만 사용\nvar _React$useState11=React.useState(1),_React$useState12=_slicedToArray(_React$useState11,2),page=_React$useState12[0],setPage=_React$useState12[1];// 부모 댓글 페이징\nvar _React$useState13=React.useState(true),_React$useState14=_slicedToArray(_React$useState13,2),last=_React$useState14[0],setLast=_React$useState14[1];// 부모 댓글 페이징 - 다음 댓글 있나 없나 여부\nvar input_id=\"commentChildInput\".concat(comment.commentParent.id);React.useEffect(function(){if(comment.commentParent!==undefined){setParentCommentEdit(comment.commentParent.contents);}},[]);// 대댓글 조회 - 대댓글은 Redux에서 관리안함\nvar showReplyComment=function showReplyComment(){setShowReply(!showReply);if(!showReply){var access_token=localStorage.getItem(\"access_token\");fetch(\"\".concat(config,\"/api/all/boards/comments/children/\").concat(comment.commentParent.id,\"?page=\").concat(page),{method:'GET',headers:{'Content-Type':'application/json','Accept':'application/json','Authorization':\"\".concat(access_token)}}).then(function(res){return res.json();}).then(function(data){setData(data.results);if(!data.last){setPage(function(prevState){return prevState+1;});setLast(data.last);}}).catch(function(err){return console.log(err,'get child comment trilog');});}};var postChildComment=function postChildComment(){if(!is_login){Swal.fire({title:\"로그인\",text:\"로그인을 먼저 해주세요.\",icon:\"warning\",showCancelButton:true,confirmButtonColor:\"#3085d6\",cancelButtonColor:\"#d33\",confirmButtonText:\"로그인하기\",cancelButtonText:\"닫기\"}).then(function(result){if(result.isConfirmed){history.push(\"/login\");}});return;}var access_token=localStorage.getItem(\"access_token\");fetch(\"\".concat(config,\"/api/boards/comments/children/\").concat(comment.commentParent.id),{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json','Authorization':\"\".concat(access_token)},body:JSON.stringify({contents:commentRef.current.value})}).then(function(res){return res.json();}).then(function(data){setData(function(prevState){return[].concat(_toConsumableArray(prevState),[data.results]);});if(!showReply){setShowReply(true);}document.getElementById(input_id).value='';Swal.fire({title:data.msg,icon:\"success\"});}).catch(function(err){return console.log(err,'child comment post');});};var hitLike=function hitLike(){if(!is_login){alert(\"로그인을 먼저 하세요!\");return;}dispatch(TrilogActions.setParentCommentLike(comment.commentParent.id));};var getMorecomment=function getMorecomment(){var access_token=localStorage.getItem(\"access_token\");fetch(\"\".concat(config,\"/api/all/boards/comments/children/\").concat(comment.commentParent.id,\"?page=\").concat(page),{method:'GET',headers:{'Content-Type':'application/json','Accept':'application/json','Authorization':\"\".concat(access_token)}}).then(function(res){return res.json();}).then(function(data){setData(function(prevState){return[].concat(_toConsumableArray(prevState),_toConsumableArray(data.results));});if(!data.last){setPage(function(prevState){return prevState+1;});setLast(data.last);}else{setPage(1);setLast(data.last);}}).catch(function(err){return console.log(err,'get child comment trilog');});};var showEdit=function showEdit(){setEdit(!edit);};var editComment=function editComment(){setEdit(!edit);dispatch(TrilogActions.editParentComment(comment.commentParent.id,parentCommentEdit));};var deleteComment=function deleteComment(){Swal.fire({title:'해당 댓글을 삭제하시겠습니까?',showDenyButton:true,showCancelButton:false,confirmButtonText:\"\\uC0AD\\uC81C\",denyButtonText:\"\\uCDE8\\uC18C\"}).then(function(result){if(result.isConfirmed){dispatch(TrilogActions.removeParentComment(comment.commentParent.id));}});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(CommentContainer,{children:[/*#__PURE__*/_jsxs(ParentComment,{children:[/*#__PURE__*/_jsxs(UserContainer,{children:[/*#__PURE__*/_jsx(\"img\",{src:comment.author.profileImgUrl}),/*#__PURE__*/_jsx(\"span\",{children:comment.author.nickname})]}),/*#__PURE__*/_jsx(Content,{children:edit?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(EditInput,{type:\"text\",value:parentCommentEdit,onChange:function onChange(e){return setParentCommentEdit(e.target.value);},onKeyPress:function onKeyPress(e){if(window.event.keyCode===13){editComment();}}})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{children:comment.commentParent.contents}),/*#__PURE__*/_jsx(Date,{children:comment.commentParent.createdAt})]})})]}),/*#__PURE__*/_jsxs(Likes,{children:[/*#__PURE__*/_jsxs(LikeSpan,{children:[/*#__PURE__*/_jsx(\"div\",{onClick:hitLike,children:/*#__PURE__*/_jsx(CommentLike,{})}),/*#__PURE__*/_jsxs(\"span\",{children:[\"+\",comment.commentParent.likeNum]})]}),/*#__PURE__*/_jsx(AddComment,{onClick:function onClick(){return setShowReplyInput(!showReplyInput);},children:\"\\uB2F5\\uAE00 \\uC791\\uC131\"}),comment.user.isMembers?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(EditButton,{type:\"button\",value:edit?\"취소\":\"수정\",onClick:showEdit}),/*#__PURE__*/_jsx(DeleteButton,{type:\"button\",value:\"\\uC0AD\\uC81C\",onClick:deleteComment})]}):/*#__PURE__*/_jsx(_Fragment,{})]}),/*#__PURE__*/_jsx(ReplyComment,{showReplyInput:showReplyInput,children:/*#__PURE__*/_jsx(\"input\",{id:input_id,type:\"text\",placeholder:\"\\uB2F5\\uAE00 \\uCD94\\uAC00...\",ref:commentRef,onKeyPress:function onKeyPress(){if(window.event.keyCode===13){postChildComment();}}})})]}),comment.commentParent.commentChildNum===0?/*#__PURE__*/_jsx(_Fragment,{}):/*#__PURE__*/_jsx(ShowComment,{children:showReply?/*#__PURE__*/_jsx(\"span\",{onClick:showReplyComment,children:\"\\uB313\\uAE00 \\uAC10\\uCD94\\uAE30 \\u25B2\"}):/*#__PURE__*/_jsxs(\"span\",{onClick:showReplyComment,children:[\"\\uB313\\uAE00 \\uBCF4\\uAE30(\",comment.commentParent.commentChildNum,\") \\u25BC\"]})}),/*#__PURE__*/_jsx(ReplyContainer,{showReply:showReply,children:data.map(function(val,index){return/*#__PURE__*/_jsx(BoardChildComment,{comment:val,parent_id:comment.commentParent.id,setData:setData},index);})}),/*#__PURE__*/_jsx(ShowMoreComment,{showReply:showReply,last:last,children:/*#__PURE__*/_jsx(\"span\",{onClick:getMorecomment,children:\"\\u2514 \\uB300\\uB313\\uAE00 \\uB354 \\uBCF4\\uAE30\"})})]});};var UserContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  margin-right: 1rem;\\n  font-family: \\\"AppleSDGothicNeoB\\\";\\n\\n  & img {\\n    width: 2.375rem;\\n    border-radius: 50%;\\n    margin-right: 0.5rem;\\n  }\\n\"])));var ParentComment=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n\"])));var CommentContainer=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  width: 100%;\\n\"])));var Content=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n\"])));var Date=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  right: 0;\\n  \\n  @media (max-width: 600px) {\\n    display: none;\\n  }\\n\"])));var Likes=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  margin: 0.5rem 0 0.5rem 2.5rem;\\n  display: flex;\\n  align-items: center;\\n\\n  & span {\\n    width: 65px;\\n  }\\n\"])));var LikeSpan=styled.span(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n\\n  & svg {\\n    cursor: pointer;\\n    width: 1.2rem;\\n    margin-right: 0.5rem;\\n  }\\n\\n  & span {\\n    font-size: 15px;\\n  }\\n\"])));var ShowComment=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  margin: 0.5rem 0;\\n  color: #2b61e1;\\n\\n  & span {\\n    cursor: pointer;\\n    font-size: 15px;\\n    margin-left: 2.5rem;\\n  }\\n\"])));var ReplyComment=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  display: \",\";\\n  align-items: center;\\n  margin: 1.5rem 0 1.5rem 2.5rem;\\n\\n  & input {\\n    outline: none;\\n    border: 0;\\n    box-sizing: border-box;\\n    width: 100%;\\n    height: 40px;\\n    border: 1px solid rgb(43,97,225,0.6);\\n    border-radius: 5px;\\n    padding: 0 1rem;\\n  }\\n\"])),function(props){return props.showReplyInput?\"flex\":\"none\";});var ReplyContainer=styled.div(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  display: \",\";\\n  margin: 0 0 1.5rem 2.5rem;\\n\"])),function(props){return props.showReply?\"block\":\"none\";});var AddComment=styled.span(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  font-size: 13px;\\n\"])));var EditButton=styled.input(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  cursor: pointer;\\n  background-color: #2b61e1;\\n  color: #fff;\\n  border: 1px solid #2b61e1;\\n  border-radius: 5px;\\n  padding: .1rem .5rem;\\n  margin: 0 .5rem;\\n  font-size: 11px;\\n\"])));var DeleteButton=styled.input(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  cursor: pointer;\\n  background-color: #f22d3f;\\n  border: 1px solid #f22d3f;\\n  color: #fff;\\n  border-radius: 5px;\\n  padding: .1rem .5rem;\\n  font-size: 11px;\\n\"])));var EditInput=styled.input(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\\n  outline: none;\\n  border: 0;\\n  box-sizing: border-box;\\n  width: 100%;\\n  height: 30px;\\n  border: 1px solid rgb(43,97,225,0.6);\\n  border-radius: 5px;\\n  padding: 0 1rem;\\n\"])));var ShowMoreComment=styled.div(_templateObject15||(_templateObject15=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  display: \",\";\\n  margin: 0 0 1.5rem 2.5rem;\\n\\n  & span {\\n      cursor: pointer;\\n  }\\n\"])),function(props){return!props.last?\"flex\":\"none\";});export default BoardComment;","map":{"version":3,"sources":["/Users/parkminkyung/Desktop/git/triport/src/components/trilog/BoardComment.js"],"names":["React","styled","CommentLike","history","BoardChildComment","actionCreators","TrilogActions","useDispatch","useSelector","config","Swal","BoardComment","props","dispatch","is_login","state","user","comment","commentRef","useRef","useState","showReply","setShowReply","showReplyInput","setShowReplyInput","data","setData","edit","setEdit","parentCommentEdit","setParentCommentEdit","page","setPage","last","setLast","input_id","commentParent","id","useEffect","undefined","contents","showReplyComment","access_token","localStorage","getItem","fetch","method","headers","then","res","json","results","prevState","catch","err","console","log","postChildComment","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","result","isConfirmed","push","body","JSON","stringify","current","value","document","getElementById","msg","hitLike","alert","setParentCommentLike","getMorecomment","showEdit","editComment","editParentComment","deleteComment","showDenyButton","denyButtonText","removeParentComment","author","profileImgUrl","nickname","e","target","window","event","keyCode","createdAt","likeNum","isMembers","commentChildNum","map","val","index","UserContainer","div","ParentComment","CommentContainer","Content","Date","Likes","LikeSpan","span","ShowComment","ReplyComment","ReplyContainer","AddComment","EditButton","input","DeleteButton","EditInput","ShowMoreComment"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { CommentLike } from \"media/svg/Svg\";\r\nimport { history } from \"redux/configureStore\";\r\nimport { BoardChildComment } from \"components/components\";\r\nimport { actionCreators as TrilogActions } from 'redux/modules/trilog';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { config } from \"redux/modules/config\";\r\nimport Swal from \"sweetalert2\";\r\n\r\nconst BoardComment = (props) => {\r\n    const dispatch = useDispatch();\r\n    const is_login = useSelector((state) => state.user.is_login); // 로그인 체크 여부\r\n\r\n    const { comment } = props; // BoardDetail 컴포넌트로부터 받은 data\r\n\r\n    const commentRef = React.useRef(); // 부모 댓글 추가 시 가져오는 내용\r\n\r\n    const [showReply, setShowReply] = React.useState(false); // 대댓글(자식 댓글) 보여주기 토글\r\n    const [showReplyInput, setShowReplyInput] = React.useState(false); // 답글 작성 토글\r\n    const [data, setData] = React.useState([]); // 대댓글(자식 댓글) 정보\r\n    const [edit, setEdit] = React.useState(false); // 부모 댓글 수정\r\n    const [parentCommentEdit, setParentCommentEdit] = React.useState(''); // Edit일때만 사용\r\n    const [page, setPage] = React.useState(1); // 부모 댓글 페이징\r\n    const [last, setLast] = React.useState(true); // 부모 댓글 페이징 - 다음 댓글 있나 없나 여부\r\n\r\n    const input_id = `commentChildInput${comment.commentParent.id}`;\r\n\r\n    React.useEffect(() => {\r\n      if(comment.commentParent !== undefined) {\r\n        setParentCommentEdit(comment.commentParent.contents);\r\n      }\r\n    }, []);\r\n\r\n    // 대댓글 조회 - 대댓글은 Redux에서 관리안함\r\n    const showReplyComment = () => {\r\n        setShowReply(!showReply);\r\n        \r\n        if(!showReply) {\r\n            const access_token = localStorage.getItem(\"access_token\");\r\n\r\n            fetch(`${config}/api/all/boards/comments/children/${comment.commentParent.id}?page=${page}`, {\r\n                method : 'GET',\r\n                headers : {\r\n                    'Content-Type': 'application/json',\r\n                    'Accept': 'application/json',\r\n                    'Authorization': `${access_token}`,\r\n                },\r\n            })\r\n            .then(res => res.json())\r\n            .then(data => {\r\n              setData(data.results);\r\n\r\n              if(!data.last) {\r\n                setPage(prevState => prevState + 1);\r\n                setLast(data.last);\r\n              }\r\n            })\r\n            .catch(err => console.log(err, 'get child comment trilog'));\r\n        }\r\n    };\r\n    \r\n    const postChildComment = () => {\r\n      if(!is_login) {\r\n          Swal.fire({\r\n            title: \"로그인\",\r\n            text: \"로그인을 먼저 해주세요.\",\r\n            icon: \"warning\",\r\n            showCancelButton: true,\r\n            confirmButtonColor: \"#3085d6\",\r\n            cancelButtonColor: \"#d33\",\r\n            confirmButtonText: \"로그인하기\",\r\n            cancelButtonText: \"닫기\",\r\n        }).then((result) => {\r\n            if (result.isConfirmed) {\r\n                history.push(\"/login\");\r\n            }\r\n        });\r\n        return;\r\n      }\r\n\r\n      const access_token = localStorage.getItem(\"access_token\");\r\n\r\n      fetch(`${config}/api/boards/comments/children/${comment.commentParent.id}`, {\r\n          method: 'POST',\r\n          headers: {\r\n              'Content-Type': 'application/json',\r\n              'Accept': 'application/json',\r\n              'Authorization': `${access_token}`,\r\n          },\r\n          body: JSON.stringify({\r\n              contents: commentRef.current.value,\r\n          })\r\n      })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        setData(prevState => [...prevState, data.results]);\r\n        if(!showReply) {\r\n          setShowReply(true);\r\n        }\r\n        document.getElementById(input_id).value = '';\r\n\r\n        Swal.fire({\r\n          title: data.msg,\r\n          icon: \"success\",\r\n      });\r\n      })\r\n      .catch(err => console.log(err, 'child comment post'));\r\n    }\r\n\r\n    const hitLike = () => {\r\n      if(!is_login) {\r\n        alert(\"로그인을 먼저 하세요!\");\r\n        return;\r\n      }\r\n      dispatch(TrilogActions.setParentCommentLike(comment.commentParent.id));\r\n    };\r\n\r\n    const getMorecomment = () => {\r\n      const access_token = localStorage.getItem(\"access_token\");\r\n\r\n      fetch(`${config}/api/all/boards/comments/children/${comment.commentParent.id}?page=${page}`, {\r\n          method : 'GET',\r\n          headers : {\r\n              'Content-Type': 'application/json',\r\n              'Accept': 'application/json',\r\n              'Authorization': `${access_token}`,\r\n          },\r\n      })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        setData(prevState => [...prevState, ...data.results]);\r\n\r\n        if(!data.last) {\r\n          setPage(prevState => prevState + 1);\r\n          setLast(data.last);\r\n        } else {\r\n          setPage(1);\r\n          setLast(data.last);\r\n        }\r\n      })\r\n      .catch(err => console.log(err, 'get child comment trilog'));\r\n    };\r\n\r\n    const showEdit = () => {\r\n      setEdit(!edit);\r\n    };\r\n\r\n    const editComment = () => {\r\n      setEdit(!edit);\r\n      dispatch(TrilogActions.editParentComment(comment.commentParent.id, parentCommentEdit));\r\n    };\r\n\r\n    const deleteComment =() => {\r\n      Swal.fire({\r\n        title: '해당 댓글을 삭제하시겠습니까?',\r\n        showDenyButton: true,\r\n        showCancelButton: false,\r\n        confirmButtonText: `삭제`,\r\n        denyButtonText: `취소`,\r\n      }).then((result) => {\r\n        if (result.isConfirmed) {\r\n          dispatch(TrilogActions.removeParentComment(comment.commentParent.id));\r\n        }\r\n      });\r\n    };\r\n\r\n    return (\r\n      <>\r\n        <CommentContainer>\r\n          <ParentComment>\r\n            <UserContainer>\r\n              <img src={comment.author.profileImgUrl} />\r\n              <span>{comment.author.nickname}</span>\r\n            </UserContainer>\r\n            <Content>\r\n              {edit ? (\r\n                <>\r\n                  <EditInput\r\n                    type=\"text\"\r\n                    value={parentCommentEdit}\r\n                    onChange={(e) => setParentCommentEdit(e.target.value)}\r\n                    onKeyPress={(e) => {\r\n                      if (window.event.keyCode === 13) {\r\n                        editComment();\r\n                      }\r\n                    }}\r\n                  />\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <div>{comment.commentParent.contents}</div>\r\n                  <Date>{comment.commentParent.createdAt}</Date>\r\n                </>\r\n              )}\r\n            </Content>\r\n          </ParentComment>\r\n          <Likes>\r\n            <LikeSpan>\r\n              <div onClick={hitLike}>\r\n                <CommentLike />\r\n              </div>\r\n              <span>+{comment.commentParent.likeNum}</span>\r\n            </LikeSpan>\r\n            <AddComment onClick={() => setShowReplyInput(!showReplyInput)}>\r\n              답글 작성\r\n            </AddComment>\r\n            {comment.user.isMembers ? (\r\n              <>\r\n                <EditButton\r\n                  type=\"button\"\r\n                  value={edit ? \"취소\" : \"수정\"}\r\n                  onClick={showEdit}\r\n                />\r\n                <DeleteButton\r\n                  type=\"button\"\r\n                  value=\"삭제\"\r\n                  onClick={deleteComment}\r\n                />\r\n              </>\r\n            ) : (\r\n              <></>\r\n            )}\r\n          </Likes>\r\n          <ReplyComment showReplyInput={showReplyInput}>\r\n            <input\r\n              id={input_id}\r\n              type=\"text\"\r\n              placeholder=\"답글 추가...\"\r\n              ref={commentRef}\r\n              onKeyPress={() => {\r\n                if (window.event.keyCode === 13) {\r\n                  postChildComment();\r\n                }\r\n              }}\r\n            />\r\n          </ReplyComment>\r\n        </CommentContainer>\r\n        {comment.commentParent.commentChildNum === 0 ? (\r\n          <></>\r\n        ) : (\r\n          <ShowComment>\r\n            {showReply ? (\r\n              <span onClick={showReplyComment}>댓글 감추기 ▲</span>\r\n            ) : (\r\n              <span onClick={showReplyComment}>\r\n                댓글 보기({comment.commentParent.commentChildNum}) ▼\r\n              </span>\r\n            )}\r\n          </ShowComment>\r\n        )}\r\n        <ReplyContainer showReply={showReply}>\r\n          {data.map((val, index) => {\r\n            return (\r\n              <BoardChildComment\r\n                key={index}\r\n                comment={val}\r\n                parent_id={comment.commentParent.id}\r\n                setData={setData}\r\n              />\r\n            );\r\n          })}\r\n        </ReplyContainer>\r\n        <ShowMoreComment showReply={showReply} last={last}>\r\n          <span onClick={getMorecomment}>└ 대댓글 더 보기</span>\r\n        </ShowMoreComment>\r\n      </>\r\n    );\r\n};\r\n\r\nconst UserContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  margin-right: 1rem;\r\n  font-family: \"AppleSDGothicNeoB\";\r\n\r\n  & img {\r\n    width: 2.375rem;\r\n    border-radius: 50%;\r\n    margin-right: 0.5rem;\r\n  }\r\n`;\r\n\r\nconst ParentComment = styled.div`\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n`;\r\n\r\nconst CommentContainer = styled.div`\r\n  width: 100%;\r\n`;\r\n\r\nconst Content = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`;\r\n\r\nconst Date = styled.div`\r\n  position: absolute;\r\n  right: 0;\r\n  \r\n  @media (max-width: 600px) {\r\n    display: none;\r\n  }\r\n`;\r\n\r\nconst Likes = styled.div`\r\n  margin: 0.5rem 0 0.5rem 2.5rem;\r\n  display: flex;\r\n  align-items: center;\r\n\r\n  & span {\r\n    width: 65px;\r\n  }\r\n`;\r\n\r\nconst LikeSpan = styled.span`\r\n  display: flex;\r\n  align-items: center;\r\n\r\n  & svg {\r\n    cursor: pointer;\r\n    width: 1.2rem;\r\n    margin-right: 0.5rem;\r\n  }\r\n\r\n  & span {\r\n    font-size: 15px;\r\n  }\r\n`;\r\n\r\nconst ShowComment = styled.div`\r\n  margin: 0.5rem 0;\r\n  color: #2b61e1;\r\n\r\n  & span {\r\n    cursor: pointer;\r\n    font-size: 15px;\r\n    margin-left: 2.5rem;\r\n  }\r\n`;\r\n\r\nconst ReplyComment = styled.div`\r\n  display: ${(props) => (props.showReplyInput ? \"flex\" : \"none\")};\r\n  align-items: center;\r\n  margin: 1.5rem 0 1.5rem 2.5rem;\r\n\r\n  & input {\r\n    outline: none;\r\n    border: 0;\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    height: 40px;\r\n    border: 1px solid rgb(43,97,225,0.6);\r\n    border-radius: 5px;\r\n    padding: 0 1rem;\r\n  }\r\n`;\r\n\r\nconst ReplyContainer = styled.div`\r\n  display: ${(props) => (props.showReply ? \"block\" : \"none\")};\r\n  margin: 0 0 1.5rem 2.5rem;\r\n`;\r\n\r\nconst AddComment = styled.span`\r\n  font-size: 13px;\r\n`;\r\n\r\nconst EditButton = styled.input`\r\n  cursor: pointer;\r\n  background-color: #2b61e1;\r\n  color: #fff;\r\n  border: 1px solid #2b61e1;\r\n  border-radius: 5px;\r\n  padding: .1rem .5rem;\r\n  margin: 0 .5rem;\r\n  font-size: 11px;\r\n`;\r\n\r\nconst DeleteButton = styled.input`\r\n  cursor: pointer;\r\n  background-color: #f22d3f;\r\n  border: 1px solid #f22d3f;\r\n  color: #fff;\r\n  border-radius: 5px;\r\n  padding: .1rem .5rem;\r\n  font-size: 11px;\r\n`;\r\n\r\nconst EditInput = styled.input`\r\n  outline: none;\r\n  border: 0;\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  height: 30px;\r\n  border: 1px solid rgb(43,97,225,0.6);\r\n  border-radius: 5px;\r\n  padding: 0 1rem;\r\n`;\r\n\r\nconst ShowMoreComment = styled.div`\r\n  width: 100%;\r\n  display: ${(props) => (!props.last ? \"flex\" : \"none\")};\r\n  margin: 0 0 1.5rem 2.5rem;\r\n\r\n  & span {\r\n      cursor: pointer;\r\n  }\r\n`;\r\n\r\nexport default BoardComment;\r\n"]},"metadata":{},"sourceType":"module"}