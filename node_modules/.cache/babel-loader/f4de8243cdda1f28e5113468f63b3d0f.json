{"ast":null,"code":"var _jsxFileName = \"/Users/parkminkyung/Desktop/git/triport/src/pages/TrilsWrite.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { TrilsActions } from \"redux/modules/trils\";\nimport afterImg from \"../media/image/afterupload.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst TrilsWrite = props => {\n  _s();\n\n  const {\n    history\n  } = props;\n  const tagInput = useRef(null);\n  const fileInput = useRef();\n  const [tags, setTags] = useState([]);\n  const dispatch = useDispatch();\n  const [vid, setVid] = useState(null);\n  const [tagType, setTagType] = useState(\"\");\n  const is_login = useSelector(state => state.user.is_login);\n  useEffect(() => {\n    if (!is_login) {\n      alert(\"로그인을 해주세요\");\n      history.replace(\"/\");\n    }\n  }, [is_login, history]);\n\n  const removeTag = i => {\n    const newTags = [...tags];\n    newTags.splice(i, 1);\n    setTags([...newTags]);\n  };\n\n  const InputKeyDown = e => {\n    const val = e.target.value;\n\n    if (e.key === \"Enter\" && val || e.key === \",\" && val || e.key === \" \" && val) {\n      if (tags.length === 3) {\n        alert(\"태그는 최대 3개까지 가능합니다.\");\n        return;\n      }\n\n      if (tags.find(tag => tag.toLowerCase() === val.toLowerCase())) {\n        return;\n      }\n\n      setTagType(\"\");\n      setTags([...tags, val]);\n    } else if (e.key === \"Backspace\" && !val) {\n      removeTag(tags.length - 1);\n    }\n  };\n\n  const post = () => {\n    if (vid === undefined || vid == null) {\n      alert(\"영상을 업로드해주세요\");\n      return;\n    }\n\n    if (tags.length === 0) {\n      alert(\"태그를 1개 이상 작성해주세요\");\n      return;\n    }\n\n    dispatch(TrilsActions.writepost(vid, tags));\n  };\n\n  const upload = e => {\n    const reader = new FileReader();\n    const file = fileInput.current.files[0];\n\n    if (!file) {\n      return;\n    }\n\n    if (file.size * 9.5367e-7 > 50) {\n      alert(\"용량이 너무 큽니다.(50mb 이하)\");\n      return;\n    }\n\n    reader.onloadstart = e => {\n      setVid(null);\n    };\n\n    reader.readAsDataURL(file);\n\n    reader.onloadend = e => {\n      setVid(file);\n    };\n  };\n\n  const triggerVideo = () => {\n    fileInput.current.click(); // 인풋 클릭한 효과\n  };\n\n  const change = e => {\n    if (e.target.value.length > 10) {\n      e.target.value = e.target.value.substr(0, 10);\n    }\n\n    const curValue = e.target.value; // const regExp = /[\\{\\}\\[\\]\\/?.,;:|\\)*~`!^\\-_+<>@\\#$%&\\\\\\=\\(\\'\\\"\\s]/gi;\n\n    const regExp = /[{}[\\]/?.,;:|)*~`!^\\-_+<>@#$%&\\\\=('\"\\s]/gi;\n    const newValue = curValue.replace(regExp, \"\");\n    setTagType(newValue);\n  };\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Wrap, {\n      children: [/*#__PURE__*/_jsxDEV(VideoView, {\n        onClick: triggerVideo,\n        children: [!(vid === null) ? /*#__PURE__*/_jsxDEV(Uploading, {\n          src: afterImg\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              fontSize: \"25px\"\n            },\n            children: \"\\uC601\\uC0C1\\uC744 \\uC5C5\\uB85C\\uB4DC\\uD574\\uC8FC\\uC138\\uC694.(\\uD074\\uB9AD)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              fontSize: \"15px\"\n            },\n            children: \"\\uC601\\uC0C1 \\uAE38\\uC774 10\\uCD08 \\uC774\\uD558, \\uD06C\\uAE30 50MB \\uC774\\uD558\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \"video/mp4\",\n          ref: fileInput,\n          onChange: upload,\n          style: {\n            display: \"none\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Text, {\n        children: tags.map((tag, i) => /*#__PURE__*/_jsxDEV(Li, {\n          children: [tag, /*#__PURE__*/_jsxDEV(Libutton, {\n            type: \"button\",\n            onClick: () => {\n              removeTag(i);\n            },\n            children: /*#__PURE__*/_jsxDEV(IconCover, {\n              children: /*#__PURE__*/_jsxDEV(ClearIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 15\n          }, this)]\n        }, tag, true, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Tag, {\n        children: \"\\uD0DC\\uADF8 (\\uCD5C\\uB300 3\\uAC1C)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(InputTag, {\n        children: /*#__PURE__*/_jsxDEV(Input, {\n          type: \"text\",\n          maxLength: 10,\n          value: tagType,\n          onKeyDown: InputKeyDown,\n          ref: tagInput,\n          placeholder: \"# \\uC790\\uC720\\uB86D\\uAC8C \\uC801\\uACE0 \\uC5D4\\uD130\\uB97C \\uB20C\\uB7EC\\uC8FC\\uC138\\uC694.(10\\uC790 \\uC81C\\uD55C)\",\n          onChange: change\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ButtonWrap, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        onClick: post,\n        children: \"\\uC791\\uC131\\uC644\\uB8CC\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        children: \"\\uCDE8\\uC18C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n};\n\n_s(TrilsWrite, \"Od9Tt+UAjZicz79HtOeDaD4kq40=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = TrilsWrite;\nconst Uploading = styled.div`\n  display: flex;\n  height: 100%;\n  width: 100%;\n  margin: 0 auto;\n  background-image: url(\"${props => props.src}\");\n  background-size: contain;\n  background-repeat: no-repeat;\n`;\n_c2 = Uploading;\nconst IconCover = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  & svg {\n    width: 1rem;\n  }\n`;\n_c3 = IconCover;\nconst Libutton = styled.div`\n  display: inline-flex;\n  align-items: center;\n  appearance: none;\n  background: #333333;\n  border: none;\n  border-radius: 50%;\n  color: white;\n  cursor: pointer;\n  font-size: 12px;\n  height: 15px;\n  justify-content: center;\n  line-height: 0;\n  margin-left: 8px;\n  padding: 0;\n  width: 15px;\n  outline: 0;\n`;\n_c4 = Libutton;\nconst Li = styled.li`\n  font-family: \"AppleSDGothicNeoR\";\n  align-items: center;\n  background: #40c7c3;\n  border-radius: 5px;\n  color: white;\n  display: flex;\n  font-weight: 300;\n  list-style: none;\n  margin-bottom: 5px;\n  margin-top: 5px;\n  margin-left: 8px;\n  padding: 5px 10px;\n`;\n_c5 = Li;\nconst InputTag = styled.div`\n  width: 37rem;\n  height: auto;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  display: inline-flex;\n  flex-wrap: wrap;\n  justify-content: flex-start;\n  margin: 0px auto;\n  padding: 5px;\n`;\n_c6 = InputTag;\nconst Wrap = styled.div`\n  font-family: \"paybooc-Bold\";\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\n_c7 = Wrap;\nconst VideoView = styled.div`\n  cursor: pointer;\n  z-index: 5;\n  width: 37rem;\n  height: 28rem;\n  margin: 0px auto;\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  color: #2b61e1;\n  margin-top: 5rem;\n`;\n_c8 = VideoView;\nconst Text = styled.div`\n  width: 37rem;\n  font-family: \"AppleSDGothicNeoR\";\n  font-size: 15px;\n  display: flex;\n  justify-content: flex-start;\n  margin: 0px auto;\n  margin-top: 1rem;\n  margin-bottom: 2rem;\n`;\n_c9 = Text;\nconst Tag = styled.div`\n  width: 37rem;\n  color: #2b61e1;\n  display: flex;\n  justify-content: flex-start;\n  margin: 0px auto;\n  margin-bottom: 1rem;\n`;\n_c10 = Tag;\nconst Input = styled.input`\n  outline: none;\n  width: 35rem;\n  height: 2.5rem;\n  border: 0;\n  border-radius: 5px;\n  display: flex;\n  justify-content: flex-start;\n  /* margin: 0px auto; */\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  font-size: 1rem;\n`;\n_c11 = Input;\nconst ButtonWrap = styled.div`\n  width: 50rem;\n  margin: 0px auto;\n  margin-top: 5rem;\n  margin-bottom: 5rem;\n  display: flex;\n  justify-content: space-between;\n`;\n_c12 = ButtonWrap;\nconst Button = styled.button`\n  cursor: pointer;\n  font-family: \"paybooc-Bold\";\n  color: #ffffff;\n  font-size: 1rem;\n  width: 20rem;\n  height: 3rem;\n  background-color: ${props => props.ok ? \"#2b61e1\" : \"#707070\"};\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid;\n  border-color: ${props => props.ok ? \"#2b61e1\" : \"#707070\"};\n  border-radius: 5px;\n`;\n_c13 = Button;\nexport default TrilsWrite;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12, _c13;\n\n$RefreshReg$(_c, \"TrilsWrite\");\n$RefreshReg$(_c2, \"Uploading\");\n$RefreshReg$(_c3, \"IconCover\");\n$RefreshReg$(_c4, \"Libutton\");\n$RefreshReg$(_c5, \"Li\");\n$RefreshReg$(_c6, \"InputTag\");\n$RefreshReg$(_c7, \"Wrap\");\n$RefreshReg$(_c8, \"VideoView\");\n$RefreshReg$(_c9, \"Text\");\n$RefreshReg$(_c10, \"Tag\");\n$RefreshReg$(_c11, \"Input\");\n$RefreshReg$(_c12, \"ButtonWrap\");\n$RefreshReg$(_c13, \"Button\");","map":{"version":3,"sources":["/Users/parkminkyung/Desktop/git/triport/src/pages/TrilsWrite.js"],"names":["React","useEffect","useRef","useState","styled","ClearIcon","useDispatch","useSelector","TrilsActions","afterImg","TrilsWrite","props","history","tagInput","fileInput","tags","setTags","dispatch","vid","setVid","tagType","setTagType","is_login","state","user","alert","replace","removeTag","i","newTags","splice","InputKeyDown","e","val","target","value","key","length","find","tag","toLowerCase","post","undefined","writepost","upload","reader","FileReader","file","current","files","size","onloadstart","readAsDataURL","onloadend","triggerVideo","click","change","substr","curValue","regExp","newValue","fontSize","display","map","Uploading","div","src","IconCover","Libutton","Li","li","InputTag","Wrap","VideoView","Text","Tag","Input","input","ButtonWrap","Button","button","ok"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { TrilsActions } from \"redux/modules/trils\";\nimport afterImg from \"../media/image/afterupload.png\";\n\nconst TrilsWrite = (props) => {\n  const { history } = props;\n  const tagInput = useRef(null);\n  const fileInput = useRef();\n  const [tags, setTags] = useState([]);\n  const dispatch = useDispatch();\n  const [vid, setVid] = useState(null);\n  const [tagType, setTagType] = useState(\"\");\n  const is_login = useSelector((state) => state.user.is_login);\n\n  useEffect(() => {\n    if (!is_login) {\n      alert(\"로그인을 해주세요\");\n      history.replace(\"/\");\n    }\n  }, [is_login, history]);\n\n  const removeTag = (i) => {\n    const newTags = [...tags];\n    newTags.splice(i, 1);\n    setTags([...newTags]);\n  };\n\n  const InputKeyDown = (e) => {\n    const val = e.target.value;\n    if (\n      (e.key === \"Enter\" && val) ||\n      (e.key === \",\" && val) ||\n      (e.key === \" \" && val)\n    ) {\n      if (tags.length === 3) {\n        alert(\"태그는 최대 3개까지 가능합니다.\");\n        return;\n      }\n      if (tags.find((tag) => tag.toLowerCase() === val.toLowerCase())) {\n        return;\n      }\n      setTagType(\"\");\n      setTags([...tags, val]);\n    } else if (e.key === \"Backspace\" && !val) {\n      removeTag(tags.length - 1);\n    }\n  };\n\n  const post = () => {\n    if (vid === undefined || vid == null) {\n      alert(\"영상을 업로드해주세요\");\n      return;\n    }\n    if (tags.length === 0) {\n      alert(\"태그를 1개 이상 작성해주세요\");\n      return;\n    }\n    dispatch(TrilsActions.writepost(vid, tags));\n  };\n\n  const upload = (e) => {\n    const reader = new FileReader();\n    const file = fileInput.current.files[0];\n    if (!file) {\n      return;\n    }\n    if (file.size * 9.5367e-7 > 50) {\n      alert(\"용량이 너무 큽니다.(50mb 이하)\");\n      return;\n    }\n    reader.onloadstart = (e) => {\n      setVid(null);\n    };\n    reader.readAsDataURL(file);\n    reader.onloadend = (e) => {\n      setVid(file);\n    };\n  };\n\n  const triggerVideo = () => {\n    fileInput.current.click(); // 인풋 클릭한 효과\n  };\n\n  const change = (e) => {\n    if (e.target.value.length > 10) {\n      e.target.value = e.target.value.substr(0, 10);\n    }\n    const curValue = e.target.value;\n    // const regExp = /[\\{\\}\\[\\]\\/?.,;:|\\)*~`!^\\-_+<>@\\#$%&\\\\\\=\\(\\'\\\"\\s]/gi;\n    const regExp = /[{}[\\]/?.,;:|)*~`!^\\-_+<>@#$%&\\\\=('\"\\s]/gi;\n    const newValue = curValue.replace(regExp, \"\");\n    setTagType(newValue);\n  };\n\n  return (\n    <React.Fragment>\n      <Wrap>\n        <VideoView onClick={triggerVideo}>\n          {!(vid === null) ? (\n            <Uploading src={afterImg} />\n          ) : (\n            <>\n              <p style={{ fontSize: \"25px\" }}>영상을 업로드해주세요.(클릭)</p>\n              <p style={{ fontSize: \"15px\" }}>\n                영상 길이 10초 이하, 크기 50MB 이하\n              </p>\n            </>\n          )}\n          <input\n            type=\"file\"\n            accept=\"video/mp4\"\n            ref={fileInput}\n            onChange={upload}\n            style={{ display: \"none\" }}\n          />\n        </VideoView>\n        <Text>\n          {tags.map((tag, i) => (\n            <Li key={tag}>\n              {tag}\n              <Libutton\n                type=\"button\"\n                onClick={() => {\n                  removeTag(i);\n                }}\n              >\n                <IconCover>\n                  <ClearIcon />\n                </IconCover>\n              </Libutton>\n            </Li>\n          ))}\n        </Text>\n        <Tag>태그 (최대 3개)</Tag>\n        <InputTag>\n          <Input\n            type=\"text\"\n            maxLength={10}\n            value={tagType}\n            onKeyDown={InputKeyDown}\n            ref={tagInput}\n            placeholder=\"# 자유롭게 적고 엔터를 눌러주세요.(10자 제한)\"\n            onChange={change}\n          ></Input>\n        </InputTag>\n      </Wrap>\n      <ButtonWrap>\n        <Button onClick={post}>작성완료</Button>\n        <Button>취소</Button>\n      </ButtonWrap>\n    </React.Fragment>\n  );\n};\n\nconst Uploading = styled.div`\n  display: flex;\n  height: 100%;\n  width: 100%;\n  margin: 0 auto;\n  background-image: url(\"${(props) => props.src}\");\n  background-size: contain;\n  background-repeat: no-repeat;\n`;\n\nconst IconCover = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  & svg {\n    width: 1rem;\n  }\n`;\n\nconst Libutton = styled.div`\n  display: inline-flex;\n  align-items: center;\n  appearance: none;\n  background: #333333;\n  border: none;\n  border-radius: 50%;\n  color: white;\n  cursor: pointer;\n  font-size: 12px;\n  height: 15px;\n  justify-content: center;\n  line-height: 0;\n  margin-left: 8px;\n  padding: 0;\n  width: 15px;\n  outline: 0;\n`;\n\nconst Li = styled.li`\n  font-family: \"AppleSDGothicNeoR\";\n  align-items: center;\n  background: #40c7c3;\n  border-radius: 5px;\n  color: white;\n  display: flex;\n  font-weight: 300;\n  list-style: none;\n  margin-bottom: 5px;\n  margin-top: 5px;\n  margin-left: 8px;\n  padding: 5px 10px;\n`;\n\nconst InputTag = styled.div`\n  width: 37rem;\n  height: auto;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  display: inline-flex;\n  flex-wrap: wrap;\n  justify-content: flex-start;\n  margin: 0px auto;\n  padding: 5px;\n`;\n\nconst Wrap = styled.div`\n  font-family: \"paybooc-Bold\";\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\n\nconst VideoView = styled.div`\n  cursor: pointer;\n  z-index: 5;\n  width: 37rem;\n  height: 28rem;\n  margin: 0px auto;\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  color: #2b61e1;\n  margin-top: 5rem;\n`;\n\nconst Text = styled.div`\n  width: 37rem;\n  font-family: \"AppleSDGothicNeoR\";\n  font-size: 15px;\n  display: flex;\n  justify-content: flex-start;\n  margin: 0px auto;\n  margin-top: 1rem;\n  margin-bottom: 2rem;\n`;\n\nconst Tag = styled.div`\n  width: 37rem;\n  color: #2b61e1;\n  display: flex;\n  justify-content: flex-start;\n  margin: 0px auto;\n  margin-bottom: 1rem;\n`;\n\nconst Input = styled.input`\n  outline: none;\n  width: 35rem;\n  height: 2.5rem;\n  border: 0;\n  border-radius: 5px;\n  display: flex;\n  justify-content: flex-start;\n  /* margin: 0px auto; */\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  font-size: 1rem;\n`;\n\nconst ButtonWrap = styled.div`\n  width: 50rem;\n  margin: 0px auto;\n  margin-top: 5rem;\n  margin-bottom: 5rem;\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst Button = styled.button`\n  cursor: pointer;\n  font-family: \"paybooc-Bold\";\n  color: #ffffff;\n  font-size: 1rem;\n  width: 20rem;\n  height: 3rem;\n  background-color: ${(props) => (props.ok ? \"#2b61e1\" : \"#707070\")};\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid;\n  border-color: ${(props) => (props.ok ? \"#2b61e1\" : \"#707070\")};\n  border-radius: 5px;\n`;\n\nexport default TrilsWrite;\n"]},"metadata":{},"sourceType":"module"}