{"ast":null,"code":"import _toConsumableArray from\"/Users/parkminkyung/Desktop/git/triport/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{createSlice}from\"@reduxjs/toolkit\";import{config}from\"./config\";import{logOut}from\"./user\";var trilseSlice=createSlice({name:\"trils\",initialState:{data:[],modal:false,detail:{information:{id:0,likeNum:0,modifiedAt:\"2021-05-20 00:00\",videoType:\"m3u8\",videoUrl:\"\",posPlay:true,hashtag:[\"트리포트\"]},author:{nickname:\"트리포트\",profileImgUrl:\"https://d1nogx3a73keco.cloudfront.net/profileImage/20210518170253-tripper_with_logo_kakao.png\"},member:{isMembers:false,isLike:false}},page:1,is_last:false},reducers:{GET_POST:function GET_POST(state,action){state.data=action.payload.result;state.page=action.payload.page;state.is_last=action.payload.is_last;},SHIFT_POST:function SHIFT_POST(state,action){var _state$data;(_state$data=state.data).push.apply(_state$data,_toConsumableArray(action.payload.result));state.page=action.payload.page;state.is_last=action.payload.is_last;},GET_POST_DETAIL:function GET_POST_DETAIL(state,action){state.modal=action.payload.modal;state.detail=action.payload.result;},MODAL_STATUS:function MODAL_STATUS(state,action){state.modal=action.payload;},LIKE_OK:function LIKE_OK(state,action){var idx=state.data.findIndex(function(p){return p.information.id===action.payload.information.id;});state.data[idx]=action.payload;state.detail=action.payload;},DELETE_POST:function DELETE_POST(state,action){var idx=state.data.findIndex(function(p){return p.information.id===action.payload;});if(idx!==-1){state.data.splice(idx,1);}},SEARCH_POST:function SEARCH_POST(state,action){state.data=action.payload.result;state.page=action.payload.page;state.is_last=action.payload.is_last;},EDIT_POST:function EDIT_POST(state,action){var idx=state.data.findIndex(function(p){return p.information.id===action.payload.id;});state.data[idx].information.hashtag=action.payload.hashtag;state.detail.information.hashtag=action.payload.hashtag;},SET_TRILS_MYPOST:function SET_TRILS_MYPOST(state,action){state.data=action.payload;}}});// Trilog 마이 페이지 게시물 조회 - 마이 페이지 내가 쓴 글 조회\nvar getMyTrilsLikePost=function getMyTrilsLikePost(){return function(dispatch,getState,_ref){var history=_ref.history;var access_token=localStorage.getItem(\"access_token\");var api=\"\".concat(config,\"/api/posts/member/like\");fetch(api,{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"\".concat(access_token)}}).then(function(res){return res.json();}).then(function(data){dispatch(SET_TRILS_MYPOST(data.results));}).catch(function(err){console.log(err);});};};// Trilog 마이 페이지 게시물 조회 - 마이 페이지 내가 쓴 글 조회\nvar getMyTrilsPost=function getMyTrilsPost(){return function(dispatch,getState,_ref2){var history=_ref2.history;var access_token=localStorage.getItem(\"access_token\");var api=\"\".concat(config,\"/api/posts/member\");fetch(api,{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"\".concat(access_token)}}).then(function(res){return res.json();}).then(function(data){dispatch(SET_TRILS_MYPOST(data.results));}).catch(function(err){console.log(err);});};};var writepost=function writepost(video,tags){return function(dispatch,getState,_ref3){var history=_ref3.history;var access_token=localStorage.getItem(\"access_token\");var formData=new FormData();formData.append(\"file\",video);tags.map(function(p,idx){return formData.append(\"hashtag\",p);});var api=\"\".concat(config,\"/api/posts\");var data={method:\"POST\",headers:{Authorization:\"\".concat(access_token)},body:formData};fetch(api,data).then(function(result){if(result.status===401){localStorage.removeItem(\"access_token\");localStorage.removeItem(\"refresh_token\");localStorage.removeItem(\"userInfo\");dispatch(logOut());alert(\"로그인 시간이 만료되었습니다. 다시 로그인해주세요.\");history.push(\"/login\");}return result.json();}).then(function(result){if(result.ok){alert(\"정상적으로 작성되었습니다.\");history.replace(\"/\");}else{alert(result.msg);}}).catch(function(err){return alert(\"업로드 중 에러가 발생했습니다.\",err);});};};var searchPost=function searchPost(){var keyword=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";var LikeOrDate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"createdAt\";var page=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;return function(dispatch,getState,_ref4){var history=_ref4.history;var access_token=localStorage.getItem(\"access_token\");var api=\"\".concat(config,\"/api/all/posts?page=\").concat(page,\"&filter=\").concat(LikeOrDate,\"&keyword=\").concat(keyword);var data={method:\"GET\",headers:{Authorization:\"\".concat(access_token)}};fetch(api,data).then(function(result){return result.json();}).then(function(result){var results={result:result.results,page:page+1,is_last:result.last};dispatch(SEARCH_POST(results));}).catch(function(err){return console.log(err);});};};var setPost=function setPost(){var keyword=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";var LikeOrDate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"likeNum\";var page=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;return function(dispatch,getState,_ref5){var history=_ref5.history;var access_token=localStorage.getItem(\"access_token\");var api=\"\".concat(config,\"/api/all/posts?page=1&filter=\").concat(LikeOrDate,\"&keyword=\").concat(keyword);var data={method:\"GET\",headers:{Authorization:\"\".concat(access_token)}};fetch(api,data).then(function(result){return result.json();}).then(function(result){var results={result:result.results,page:page+1,is_last:result.last};dispatch(GET_POST(results));}).catch(function(err){return console.log(err);});};};var getPost=function getPost(){var keyword=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";var LikeOrDate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"likeNum\";return function(dispatch,getState,_ref6){var history=_ref6.history;var page=getState().trils.page;var access_token=localStorage.getItem(\"access_token\");var api=\"\".concat(config,\"/api/all/posts?page=\").concat(page,\"&filter=\").concat(LikeOrDate,\"&keyword=\").concat(keyword);var data={method:\"GET\",headers:{Authorization:\"\".concat(access_token)}};fetch(api,data).then(function(result){return result.json();}).then(function(result){var results={result:result.results,page:page+1,is_last:result.last};if(page===1){dispatch(GET_POST(results));}else{dispatch(SHIFT_POST(results));}}).catch(function(err){return console.log(err);});};};var filterPost=function filterPost(){var keyword=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";var LikeOrDate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"likeNum\";var page=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;return function(dispatch,getState,_ref7){var history=_ref7.history;var access_token=localStorage.getItem(\"access_token\");var api=\"\".concat(config,\"/api/all/posts?page=1&filter=\").concat(LikeOrDate,\"&keyword=\").concat(keyword);var data={method:\"GET\",headers:{Authorization:\"\".concat(access_token)}};fetch(api,data).then(function(result){return result.json();}).then(function(result){var results={result:result.results,page:page+1,is_last:result.last};dispatch(GET_POST(results));}).catch(function(err){return console.log(err);});};};var getPostDetail=function getPostDetail(postId){var modal=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;return function(dispatch,getState,_ref8){var history=_ref8.history;dispatch(MODAL_STATUS(false));var access_token=localStorage.getItem(\"access_token\");var api=\"\".concat(config,\"/api/all/posts/detail/\").concat(postId);var data={method:\"GET\",headers:{Authorization:\"\".concat(access_token)}};fetch(api,data).then(function(result){return result.json();}).then(function(result){var results={result:result.results,modal:modal};dispatch(GET_POST_DETAIL(results));}).catch(function(err){return console.log(err);});};};var send_like=function send_like(postId,like){return function(dispatch,getState,_ref9){var history=_ref9.history;var access_token=localStorage.getItem(\"access_token\");var api=\"\".concat(config,\"/api/posts/like/\").concat(postId);var data={method:\"POST\",headers:{Authorization:\"\".concat(access_token)}};fetch(api,data).then(function(result){if(result.status===401){localStorage.removeItem(\"access_token\");localStorage.removeItem(\"refresh_token\");localStorage.removeItem(\"userInfo\");dispatch(logOut());alert(\"로그인 시간이 만료되었습니다. 다시 로그인해주세요.\");history.push(\"/login\");}return result.json();}).then(function(result){if(result.ok){dispatch(LIKE_OK(result.results));}else{alert(result.msg);}}).catch(function(err){return console.log(err);});};};var _trilseSlice$actions=trilseSlice.actions,GET_POST=_trilseSlice$actions.GET_POST,SHIFT_POST=_trilseSlice$actions.SHIFT_POST,GET_POST_DETAIL=_trilseSlice$actions.GET_POST_DETAIL,MODAL_STATUS=_trilseSlice$actions.MODAL_STATUS,LIKE_OK=_trilseSlice$actions.LIKE_OK,DELETE_POST=_trilseSlice$actions.DELETE_POST,SEARCH_POST=_trilseSlice$actions.SEARCH_POST,EDIT_POST=_trilseSlice$actions.EDIT_POST,SET_TRILS_MYPOST=_trilseSlice$actions.SET_TRILS_MYPOST;export{GET_POST,SHIFT_POST,GET_POST_DETAIL,MODAL_STATUS,LIKE_OK,DELETE_POST,SEARCH_POST,EDIT_POST,SET_TRILS_MYPOST};export var TrilsActions={writepost:writepost,getPost:getPost,getPostDetail:getPostDetail,send_like:send_like,searchPost:searchPost,setPost:setPost,filterPost:filterPost,getMyTrilsPost:getMyTrilsPost,getMyTrilsLikePost:getMyTrilsLikePost};export default trilseSlice.reducer;","map":{"version":3,"sources":["/Users/parkminkyung/Desktop/git/triport/src/redux/modules/trils.js"],"names":["createSlice","config","logOut","trilseSlice","name","initialState","data","modal","detail","information","id","likeNum","modifiedAt","videoType","videoUrl","posPlay","hashtag","author","nickname","profileImgUrl","member","isMembers","isLike","page","is_last","reducers","GET_POST","state","action","payload","result","SHIFT_POST","push","GET_POST_DETAIL","MODAL_STATUS","LIKE_OK","idx","findIndex","p","DELETE_POST","splice","SEARCH_POST","EDIT_POST","SET_TRILS_MYPOST","getMyTrilsLikePost","dispatch","getState","history","access_token","localStorage","getItem","api","fetch","method","headers","Accept","Authorization","then","res","json","results","catch","err","console","log","getMyTrilsPost","writepost","video","tags","formData","FormData","append","map","body","status","removeItem","alert","ok","replace","msg","searchPost","keyword","LikeOrDate","last","setPost","getPost","trils","filterPost","getPostDetail","postId","send_like","like","actions","TrilsActions","reducer"],"mappings":"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","sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nimport { config } from \"./config\";\nimport { logOut } from \"./user\";\n\nconst trilseSlice = createSlice({\n  name: \"trils\",\n  initialState: {\n    data: [],\n    modal: false,\n    detail: {\n      information: {\n        id: 0,\n        likeNum: 0,\n        modifiedAt: \"2021-05-20 00:00\",\n        videoType: \"m3u8\",\n        videoUrl: \"\",\n        posPlay: true,\n        hashtag: [\"트리포트\"],\n      },\n      author: {\n        nickname: \"트리포트\",\n        profileImgUrl:\n          \"https://d1nogx3a73keco.cloudfront.net/profileImage/20210518170253-tripper_with_logo_kakao.png\",\n      },\n      member: { isMembers: false, isLike: false },\n    },\n    page: 1,\n    is_last: false,\n  },\n  reducers: {\n    GET_POST: (state, action) => {\n      state.data = action.payload.result;\n      state.page = action.payload.page;\n      state.is_last = action.payload.is_last;\n    },\n    SHIFT_POST: (state, action) => {\n      state.data.push(...action.payload.result);\n      state.page = action.payload.page;\n      state.is_last = action.payload.is_last;\n    },\n    GET_POST_DETAIL: (state, action) => {\n      state.modal = action.payload.modal;\n      state.detail = action.payload.result;\n    },\n    MODAL_STATUS: (state, action) => {\n      state.modal = action.payload;\n    },\n    LIKE_OK: (state, action) => {\n      const idx = state.data.findIndex(\n        (p) => p.information.id === action.payload.information.id\n      );\n      state.data[idx] = action.payload;\n      state.detail = action.payload;\n    },\n    DELETE_POST: (state, action) => {\n      const idx = state.data.findIndex(\n        (p) => p.information.id === action.payload\n      );\n      if (idx !== -1) {\n        state.data.splice(idx, 1);\n      }\n    },\n    SEARCH_POST: (state, action) => {\n      state.data = action.payload.result;\n      state.page = action.payload.page;\n      state.is_last = action.payload.is_last;\n    },\n    EDIT_POST: (state, action) => {\n      const idx = state.data.findIndex(\n        (p) => p.information.id === action.payload.id\n      );\n      state.data[idx].information.hashtag = action.payload.hashtag;\n      state.detail.information.hashtag = action.payload.hashtag;\n    },\n    SET_TRILS_MYPOST: (state, action) => {\n      state.data = action.payload;\n    },\n  },\n});\n\n// Trilog 마이 페이지 게시물 조회 - 마이 페이지 내가 쓴 글 조회\nconst getMyTrilsLikePost = () => {\n  return function (dispatch, getState, { history }) {\n    const access_token = localStorage.getItem(\"access_token\");\n    const api = `${config}/api/posts/member/like`;\n\n    fetch(api, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `${access_token}`,\n      },\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        dispatch(SET_TRILS_MYPOST(data.results));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\n// Trilog 마이 페이지 게시물 조회 - 마이 페이지 내가 쓴 글 조회\nconst getMyTrilsPost = () => {\n  return function (dispatch, getState, { history }) {\n    const access_token = localStorage.getItem(\"access_token\");\n    const api = `${config}/api/posts/member`;\n\n    fetch(api, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `${access_token}`,\n      },\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        dispatch(SET_TRILS_MYPOST(data.results));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\nconst writepost = (video, tags) => {\n  return function (dispatch, getState, { history }) {\n    const access_token = localStorage.getItem(\"access_token\");\n    let formData = new FormData();\n    formData.append(\"file\", video);\n    tags.map((p, idx) => formData.append(\"hashtag\", p));\n    const api = `${config}/api/posts`;\n    const data = {\n      method: \"POST\",\n      headers: {\n        Authorization: `${access_token}`,\n      },\n      body: formData,\n    };\n    fetch(api, data)\n      .then((result) => {\n        if (result.status === 401) {\n          localStorage.removeItem(\"access_token\");\n          localStorage.removeItem(\"refresh_token\");\n          localStorage.removeItem(\"userInfo\");\n          dispatch(logOut());\n          alert(\"로그인 시간이 만료되었습니다. 다시 로그인해주세요.\");\n          history.push(\"/login\");\n        }\n        return result.json();\n      })\n      .then((result) => {\n        if (result.ok) {\n          alert(\"정상적으로 작성되었습니다.\");\n          history.replace(\"/\");\n        } else {\n          alert(result.msg);\n        }\n      })\n      .catch((err) => alert(\"업로드 중 에러가 발생했습니다.\", err));\n  };\n};\n\nconst searchPost = (keyword = \"\", LikeOrDate = \"createdAt\", page = 1) => {\n  return function (dispatch, getState, { history }) {\n    const access_token = localStorage.getItem(\"access_token\");\n    const api = `${config}/api/all/posts?page=${page}&filter=${LikeOrDate}&keyword=${keyword}`;\n    const data = {\n      method: \"GET\",\n      headers: {\n        Authorization: `${access_token}`,\n      },\n    };\n    fetch(api, data)\n      .then((result) => {\n        return result.json();\n      })\n      .then((result) => {\n        const results = {\n          result: result.results,\n          page: page + 1,\n          is_last: result.last,\n        };\n        dispatch(SEARCH_POST(results));\n      })\n      .catch((err) => console.log(err));\n  };\n};\n\nconst setPost = (keyword = \"\", LikeOrDate = \"likeNum\", page = 1) => {\n  return function (dispatch, getState, { history }) {\n    const access_token = localStorage.getItem(\"access_token\");\n    const api = `${config}/api/all/posts?page=1&filter=${LikeOrDate}&keyword=${keyword}`;\n    const data = {\n      method: \"GET\",\n      headers: {\n        Authorization: `${access_token}`,\n      },\n    };\n    fetch(api, data)\n      .then((result) => {\n        return result.json();\n      })\n      .then((result) => {\n        const results = {\n          result: result.results,\n          page: page + 1,\n          is_last: result.last,\n        };\n        dispatch(GET_POST(results));\n      })\n      .catch((err) => console.log(err));\n  };\n};\n\nconst getPost = (keyword = \"\", LikeOrDate = \"likeNum\") => {\n  return function (dispatch, getState, { history }) {\n    const page = getState().trils.page;\n    const access_token = localStorage.getItem(\"access_token\");\n    const api = `${config}/api/all/posts?page=${page}&filter=${LikeOrDate}&keyword=${keyword}`;\n    const data = {\n      method: \"GET\",\n      headers: {\n        Authorization: `${access_token}`,\n      },\n    };\n    fetch(api, data)\n      .then((result) => {\n        return result.json();\n      })\n      .then((result) => {\n        const results = {\n          result: result.results,\n          page: page + 1,\n          is_last: result.last,\n        };\n        if (page === 1) {\n          dispatch(GET_POST(results));\n        } else {\n          dispatch(SHIFT_POST(results));\n        }\n      })\n      .catch((err) => console.log(err));\n  };\n};\n\nconst filterPost = (keyword = \"\", LikeOrDate = \"likeNum\", page = 1) => {\n  return function (dispatch, getState, { history }) {\n    const access_token = localStorage.getItem(\"access_token\");\n    const api = `${config}/api/all/posts?page=1&filter=${LikeOrDate}&keyword=${keyword}`;\n    const data = {\n      method: \"GET\",\n      headers: {\n        Authorization: `${access_token}`,\n      },\n    };\n    fetch(api, data)\n      .then((result) => {\n        return result.json();\n      })\n      .then((result) => {\n        const results = {\n          result: result.results,\n          page: page + 1,\n          is_last: result.last,\n        };\n        dispatch(GET_POST(results));\n      })\n      .catch((err) => console.log(err));\n  };\n};\n\nconst getPostDetail = (postId, modal = true) => {\n  return function (dispatch, getState, { history }) {\n    dispatch(MODAL_STATUS(false));\n    const access_token = localStorage.getItem(\"access_token\");\n    const api = `${config}/api/all/posts/detail/${postId}`;\n    const data = {\n      method: \"GET\",\n      headers: {\n        Authorization: `${access_token}`,\n      },\n    };\n    fetch(api, data)\n      .then((result) => {\n        return result.json();\n      })\n      .then((result) => {\n        const results = {\n          result: result.results,\n          modal: modal,\n        };\n        dispatch(GET_POST_DETAIL(results));\n      })\n      .catch((err) => console.log(err));\n  };\n};\n\nconst send_like = (postId, like) => {\n  return function (dispatch, getState, { history }) {\n    const access_token = localStorage.getItem(\"access_token\");\n    const api = `${config}/api/posts/like/${postId}`;\n    const data = {\n      method: \"POST\",\n      headers: {\n        Authorization: `${access_token}`,\n      },\n    };\n    fetch(api, data)\n      .then((result) => {\n        if (result.status === 401) {\n          localStorage.removeItem(\"access_token\");\n          localStorage.removeItem(\"refresh_token\");\n          localStorage.removeItem(\"userInfo\");\n          dispatch(logOut());\n          alert(\"로그인 시간이 만료되었습니다. 다시 로그인해주세요.\");\n          history.push(\"/login\");\n        }\n        return result.json();\n      })\n      .then((result) => {\n        if (result.ok) {\n          dispatch(LIKE_OK(result.results));\n        } else {\n          alert(result.msg);\n        }\n      })\n      .catch((err) => console.log(err));\n  };\n};\n\nexport const {\n  GET_POST,\n  SHIFT_POST,\n  GET_POST_DETAIL,\n  MODAL_STATUS,\n  LIKE_OK,\n  DELETE_POST,\n  SEARCH_POST,\n  EDIT_POST,\n  SET_TRILS_MYPOST,\n} = trilseSlice.actions;\n\nexport const TrilsActions = {\n  writepost,\n  getPost,\n  getPostDetail,\n  send_like,\n  searchPost,\n  setPost,\n  filterPost,\n  getMyTrilsPost,\n  getMyTrilsLikePost,\n};\n\nexport default trilseSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}