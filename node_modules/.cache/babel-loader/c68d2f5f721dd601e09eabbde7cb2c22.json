{"ast":null,"code":"var _jsxFileName = \"/Users/parkminkyung/Desktop/git/triport/src/components/trils/TrilsDetail.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { HeartEmpty, HeartFill } from \"media/svg/Svg\";\nimport { CLOSE_MODAL } from \"redux/modules/trils\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Hls from \"hls.js\";\nimport ProgressBar from \"./ProgressBar\";\nimport { TrilsActions, DELETE_POST } from \"redux/modules/trils\";\nimport Swal from \"sweetalert2\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport { config } from \"../../redux/modules/config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst TrilsDetail = props => {\n  _s();\n\n  const {\n    history\n  } = props;\n  const hls = new Hls();\n  const player = useRef(null);\n  const info = useSelector(state => state.trils.detail);\n  const dispatch = useDispatch();\n  const [completed, setCompleted] = useState(0);\n  const [progress, setProgress] = useState(0);\n  const [editOn, setEditOn] = useState(false);\n  const [tags, setTags] = useState(info.information.hashtag);\n  const tagInput = useRef(null);\n  console.log(info);\n\n  const removeTag = i => {\n    const newTags = [...tags];\n    newTags.splice(i, 1);\n    console.log(newTags);\n    setTags([...newTags]);\n  };\n\n  const InputKeyDown = e => {\n    const val = e.target.value;\n\n    if (e.key === \"Enter\" && val) {\n      if (tags.length === 3) {\n        alert(\"태그는 최대 3개까지 가능합니다.\");\n        return;\n      }\n\n      if (tags.find(tag => tag.toLowerCase() === val.toLowerCase())) {\n        return;\n      }\n\n      setTags([...tags, val]);\n      tagInput.current.value = null;\n    } else if (e.key === \"Backspace\" && !val) {\n      removeTag(tags.length - 1);\n    }\n  };\n\n  const closeModal = () => {\n    dispatch(CLOSE_MODAL());\n  };\n\n  const params = {\n    src: info.information.videoUrl\n  };\n  useEffect(() => {\n    if (hls === undefined) {\n      return;\n    }\n\n    if (Hls.isSupported()) {\n      hls.attachMedia(player.current);\n      hls.config.debug = false;\n      hls.on(Hls.Events.MEDIA_ATTACHED, (event, data) => {\n        hls.loadSource(params.src);\n      });\n      hls.on(Hls.Events.ERROR, (event, data) => {\n        if (data.fatal) {\n          switch (data.type) {\n            case Hls.ErrorTypes.NETWORK_ERROR:\n              console.log(\"네트워크 오류\");\n              hls.startLoad();\n              break;\n\n            case Hls.ErrorTypes.MEDIA_ERROR:\n              console.log(\"미디어 오류\");\n              hls.recoverMediaError();\n              break;\n\n            default:\n              hls.destroy();\n              break;\n          }\n        }\n      });\n      return () => hls.destroy();\n    } else if (player.current.canPlayType(\"application/vnd.apple.mpegurl\")) {\n      player.current.src = params.src;\n      player.current.addEventListener(\"loadedmetadata\", () => {\n        player.current.play();\n      });\n    }\n  }, []);\n\n  const videoplay = () => {\n    if (player.current.readyState !== 4) {\n      return;\n    }\n\n    player.current.play();\n  };\n\n  const videopause = () => {\n    if (player.current.readyState !== 4) {\n      return;\n    }\n\n    player.current.pause();\n  };\n\n  const like = () => {\n    const access_token = localStorage.getItem(\"access_token\");\n\n    if (!access_token) {\n      Swal.fire({\n        title: \"로그인을 해주세요.\",\n        text: \"로그인 후 좋아요를 누를 수 있습니다.\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#3085d6\",\n        cancelButtonColor: \"#d33\",\n        confirmButtonText: \"로그인하기\",\n        cancelButtonText: \"닫기\"\n      }).then(result => {\n        if (result.isConfirmed) {\n          history.push(\"/login\");\n        }\n      });\n    }\n\n    dispatch(TrilsActions.send_like(info.information.id, info.member.isLike));\n  };\n\n  const del = () => {\n    Swal.fire({\n      title: \"게시글을 삭제하시겠습니까?\",\n      text: \"게시글 삭제 시 다시 복구할 수 없습니다.\",\n      icon: \"warning\",\n      showCancelButton: true,\n      confirmButtonColor: \"#3085d6\",\n      cancelButtonColor: \"#d33\",\n      confirmButtonText: \"삭제\",\n      cancelButtonText: \"취소\"\n    }).then(result => {\n      if (result.isConfirmed) {\n        const access_token = localStorage.getItem(\"access_token\");\n        const url = `${config}/api/posts/${info.information.id}`;\n        const data = {\n          method: \"DELETE\",\n          headers: {\n            Authorization: `${access_token}`\n          }\n        };\n        fetch(url, data).then(result => {\n          return result.json();\n        }).then(result => {\n          if (result.ok) {\n            dispatch(DELETE_POST(info.information.id));\n            Swal.fire(\"삭제 완료!\", \"게시글이 삭제되었습니다.\", \"success\").then(() => {\n              closeModal();\n            });\n          }\n        }).catch(err => console.log(err));\n      }\n    });\n  };\n\n  const hash = e => {\n    history.push(`/search?q=${e.target.id}&filter=likeNum`, 1);\n    closeModal();\n  };\n\n  const edit = () => {\n    setEditOn(true);\n  };\n\n  const cancelEdit = () => {\n    setEditOn(false);\n  };\n\n  const doEdit = () => {\n    const access_token = localStorage.getItem(\"access_token\");\n    const url = `${config}/api/posts/${info.information.id}`;\n    const data = {\n      method: \"PUT\",\n      headers: {\n        Authorization: `${access_token}`\n      },\n      body: {\n        hashtag: tags\n      }\n    };\n    fetch(url, data).then(result => {\n      return result.json();\n    }).then(result => {\n      if (result.ok) {\n        console.log(result);\n      }\n    }).catch(err => console.log(err));\n  };\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Component, {\n      onClick: closeModal\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Wrap, {\n      children: [/*#__PURE__*/_jsxDEV(Profile, {\n        children: [/*#__PURE__*/_jsxDEV(ProfileImg, {\n          src: info.author.profileImgUrl\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProfileId, {\n          children: info.author.nickname\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(View, {\n        onMouseOver: videoplay,\n        onMouseLeave: videopause,\n        children: /*#__PURE__*/_jsxDEV(VideoPlay, {\n          ref: player,\n          muted: true,\n          loop: true,\n          onTimeUpdate: () => {\n            setCompleted(player.current.currentTime / player.current.duration * 100);\n            setProgress(player.current.clientWidth);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Progress, {\n        width: progress,\n        children: /*#__PURE__*/_jsxDEV(ProgressBar, {\n          bgcolor: \"#6a1b9a\",\n          completed: completed\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(LowWrap, {\n        children: [/*#__PURE__*/_jsxDEV(LikeCov, {\n          onClick: like,\n          children: info.member.isLike ? /*#__PURE__*/_jsxDEV(HeartFill, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 35\n          }, this) : /*#__PURE__*/_jsxDEV(HeartEmpty, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 51\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: \"#8B8888\",\n            width: \"5rem\"\n          },\n          children: [\"\\uC88B\\uC544\\uC694 +\", info.information.likeNum]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Tag, {\n          children: editOn ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: tags.map((tag, i) => /*#__PURE__*/_jsxDEV(Li, {\n              children: [\"#\", tag, /*#__PURE__*/_jsxDEV(Libutton, {\n                type: \"button\",\n                onClick: () => {\n                  removeTag(i);\n                },\n                children: /*#__PURE__*/_jsxDEV(IconCover, {\n                  children: /*#__PURE__*/_jsxDEV(ClearIcon, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 253,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 252,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 21\n              }, this)]\n            }, tag, true, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 19\n            }, this))\n          }, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: info.information.hashtag.map((p, idx) => {\n              return /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: /*#__PURE__*/_jsxDEV(Hash, {\n                  id: p,\n                  onClick: hash,\n                  children: [\"#\", p]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false);\n            })\n          }, void 0, false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 9\n      }, this), editOn ? /*#__PURE__*/_jsxDEV(InputTag, {\n        children: /*#__PURE__*/_jsxDEV(Input, {\n          type: \"text\",\n          onKeyDown: InputKeyDown,\n          ref: tagInput,\n          placeholder: \"# \\uC790\\uC720\\uB86D\\uAC8C \\uC801\\uACE0 \\uC5D4\\uD130\\uB97C \\uB20C\\uB7EC\\uC8FC\\uC138\\uC694.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), /*#__PURE__*/_jsxDEV(Bottom, {\n        children: [editOn ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Edit, {\n            onClick: doEdit,\n            children: \"\\uC218\\uC815\\uC644\\uB8CC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Delete, {\n            onClick: cancelEdit,\n            children: \"\\uC218\\uC815\\uCDE8\\uC18C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: info.member.isMembers ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Edit, {\n              onClick: edit,\n              children: \"\\uC218\\uC815\\uD558\\uAE30\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 296,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Delete, {\n              onClick: del,\n              children: \"\\uC0AD\\uC81C\\uD558\\uAE30\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)\n        }, void 0, false), /*#__PURE__*/_jsxDEV(Close, {\n          onClick: closeModal,\n          children: \"\\uB2EB\\uAE30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 210,\n    columnNumber: 5\n  }, this);\n};\n\n_s(TrilsDetail, \"0pgV+EhYe/FeEkl97Az3ggPyEyU=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c = TrilsDetail;\nconst Input = styled.input`\n  outline: none;\n  width: 100%;\n  height: 2.5rem;\n  border: 0;\n  border-radius: 5px;\n  display: flex;\n  justify-content: flex-start;\n  /* margin: 0px auto; */\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  font-size: 1rem;\n`;\n_c2 = Input;\nconst InputTag = styled.div`\n  min-width: 30rem;\n  width: 100%;\n  height: 100%;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  display: inline-flex;\n  flex-wrap: wrap;\n  justify-content: flex-start;\n  margin: 0px auto;\n  padding: 5px;\n  margin-bottom: 1rem;\n`;\n_c3 = InputTag;\nconst IconCover = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  & svg {\n    width: 1rem;\n  }\n`;\n_c4 = IconCover;\nconst Libutton = styled.div`\n  display: inline-flex;\n  align-items: center;\n  appearance: none;\n  background: #333333;\n  border: none;\n  border-radius: 50%;\n  color: white;\n  cursor: pointer;\n  font-size: 12px;\n  height: 15px;\n  justify-content: center;\n  line-height: 0;\n  margin-left: 8px;\n  padding: 0;\n  width: 15px;\n  outline: 0;\n`;\n_c5 = Libutton;\nconst Li = styled.p`\n  cursor: pointer;\n  margin-left: 0.5rem;\n  margin-right: 1rem;\n  font-family: \"AppleSDGothicNeoR\";\n  color: blue;\n  display: flex;\n  align-items: center;\n`;\n_c6 = Li;\nconst Bottom = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n`;\n_c7 = Bottom;\nconst Edit = styled.button`\n  cursor: pointer;\n  font-family: \"TTTogether\";\n  font-size: 1rem;\n  color: #ffffff;\n  background-color: #2b61e1;\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  width: 8rem;\n  height: 3rem;\n`;\n_c8 = Edit;\nconst Delete = styled.button`\n  cursor: pointer;\n  font-family: \"TTTogether\";\n  font-size: 1rem;\n  color: #ffffff;\n  background-color: #2b61e1;\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  width: 8rem;\n  height: 3rem;\n  margin-left: 1rem;\n`;\n_c9 = Delete;\nconst Close = styled.button`\n  cursor: pointer;\n  font-family: \"TTTogether\";\n  font-size: 1rem;\n  color: #ffffff;\n  background-color: #2b61e1;\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  width: 8rem;\n  height: 3rem;\n  margin-left: 1rem;\n`;\n_c10 = Close;\nconst Progress = styled.div`\n  margin: 0 auto;\n  width: ${props => props.width}px;\n`;\n_c11 = Progress;\nconst VideoPlay = styled.video`\n  display: flex;\n  margin: 0 auto;\n  max-width: 50rem;\n  max-height: 21.5rem;\n  /* object-fit: cover; */\n`;\n_c12 = VideoPlay;\nconst VideoBg = styled.div`\n  display: flex;\n  height: 25rem;\n  width: 25rem;\n  border-radius: 20px;\n  background: beige;\n  margin-top: -25rem;\n  z-index: -99;\n`;\nconst Hash = styled.div`\n  cursor: pointer;\n  margin-left: 0.5rem;\n  font-family: \"AppleSDGothicNeoR\";\n  color: blue;\n  transition: 0.5s ease-in-out;\n  :hover {\n    transform: scale(1.2);\n  }\n`;\n_c13 = Hash;\nconst Component = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  height: 100vh;\n  width: 100vw;\n  background-color: black;\n  z-index: 10;\n  opacity: 0.4;\n`;\n_c14 = Component;\nconst Wrap = styled.div`\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 20;\n  background-color: white;\n  max-width: 57rem;\n  max-height: 37rem;\n  display: flex;\n  flex-direction: column;\n  /* justify-content: center;\n  align-items: center; */\n  margin: 0px auto;\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  padding: 3rem;\n  z-index: 98;\n`;\n_c15 = Wrap;\nconst LowWrap = styled.div`\n  display: flex;\n  flex-direction: row;\n  margin-left: 1rem;\n  margin-top: 1rem;\n  margin-bottom: 2rem;\n`;\n_c16 = LowWrap;\nconst Profile = styled.div`\n  display: flex;\n  height: 3rem;\n  align-items: center;\n  margin-bottom: 1rem;\n`;\n_c17 = Profile;\nconst ProfileImg = styled.div`\n  --size: 38px;\n  width: var(--size);\n  height: var(--size);\n  border-radius: var(--size);\n  background-position: center;\n  background-image: url(${props => props.src});\n  background-size: cover;\n  margin-left: 16px;\n  display: flex;\n`;\n_c18 = ProfileImg;\nconst ProfileId = styled.div`\n  display: flex;\n  font-weight: 600;\n  font-size: 1rem;\n  margin-left: 11px;\n  align-items: center;\n`;\n_c19 = ProfileId;\nconst View = styled.div`\n  max-width: 50rem;\n  max-height: 21.5rem;\n  width: auto;\n  height: auto;\n  background-color: #ededed;\n  /* background-color: #ededed; */\n  display: flex;\n  justify-content: center;\n  margin: 0px auto;\n`;\n_c20 = View;\nconst LikeCov = styled.div`\n  margin-right: 1rem;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  z-index: 10;\n  & svg {\n    width: 1.5rem;\n  }\n`;\n_c21 = LikeCov;\nconst Tag = styled.p`\n  font-weight: 700;\n  margin-left: 1rem;\n  display: flex;\n  flex-direction: row;\n`;\n_c22 = Tag;\nexport default TrilsDetail;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12, _c13, _c14, _c15, _c16, _c17, _c18, _c19, _c20, _c21, _c22;\n\n$RefreshReg$(_c, \"TrilsDetail\");\n$RefreshReg$(_c2, \"Input\");\n$RefreshReg$(_c3, \"InputTag\");\n$RefreshReg$(_c4, \"IconCover\");\n$RefreshReg$(_c5, \"Libutton\");\n$RefreshReg$(_c6, \"Li\");\n$RefreshReg$(_c7, \"Bottom\");\n$RefreshReg$(_c8, \"Edit\");\n$RefreshReg$(_c9, \"Delete\");\n$RefreshReg$(_c10, \"Close\");\n$RefreshReg$(_c11, \"Progress\");\n$RefreshReg$(_c12, \"VideoPlay\");\n$RefreshReg$(_c13, \"Hash\");\n$RefreshReg$(_c14, \"Component\");\n$RefreshReg$(_c15, \"Wrap\");\n$RefreshReg$(_c16, \"LowWrap\");\n$RefreshReg$(_c17, \"Profile\");\n$RefreshReg$(_c18, \"ProfileImg\");\n$RefreshReg$(_c19, \"ProfileId\");\n$RefreshReg$(_c20, \"View\");\n$RefreshReg$(_c21, \"LikeCov\");\n$RefreshReg$(_c22, \"Tag\");","map":{"version":3,"sources":["/Users/parkminkyung/Desktop/git/triport/src/components/trils/TrilsDetail.js"],"names":["React","useEffect","useRef","useState","styled","HeartEmpty","HeartFill","CLOSE_MODAL","useDispatch","useSelector","Hls","ProgressBar","TrilsActions","DELETE_POST","Swal","ClearIcon","config","TrilsDetail","props","history","hls","player","info","state","trils","detail","dispatch","completed","setCompleted","progress","setProgress","editOn","setEditOn","tags","setTags","information","hashtag","tagInput","console","log","removeTag","i","newTags","splice","InputKeyDown","e","val","target","value","key","length","alert","find","tag","toLowerCase","current","closeModal","params","src","videoUrl","undefined","isSupported","attachMedia","debug","on","Events","MEDIA_ATTACHED","event","data","loadSource","ERROR","fatal","type","ErrorTypes","NETWORK_ERROR","startLoad","MEDIA_ERROR","recoverMediaError","destroy","canPlayType","addEventListener","play","videoplay","readyState","videopause","pause","like","access_token","localStorage","getItem","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","then","result","isConfirmed","push","send_like","id","member","isLike","del","url","method","headers","Authorization","fetch","json","ok","catch","err","hash","edit","cancelEdit","doEdit","body","author","profileImgUrl","nickname","currentTime","duration","clientWidth","color","width","likeNum","map","p","idx","isMembers","Input","input","InputTag","div","IconCover","Libutton","Li","Bottom","Edit","button","Delete","Close","Progress","VideoPlay","video","VideoBg","Hash","Component","Wrap","LowWrap","Profile","ProfileImg","ProfileId","View","LikeCov","Tag"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { HeartEmpty, HeartFill } from \"media/svg/Svg\";\nimport { CLOSE_MODAL } from \"redux/modules/trils\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Hls from \"hls.js\";\nimport ProgressBar from \"./ProgressBar\";\nimport { TrilsActions, DELETE_POST } from \"redux/modules/trils\";\nimport Swal from \"sweetalert2\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport { config } from \"../../redux/modules/config\";\n\nconst TrilsDetail = (props) => {\n  const { history } = props;\n  const hls = new Hls();\n  const player = useRef(null);\n  const info = useSelector((state) => state.trils.detail);\n  const dispatch = useDispatch();\n  const [completed, setCompleted] = useState(0);\n  const [progress, setProgress] = useState(0);\n  const [editOn, setEditOn] = useState(false);\n  const [tags, setTags] = useState(info.information.hashtag);\n  const tagInput = useRef(null);\n  console.log(info);\n\n  const removeTag = (i) => {\n    const newTags = [...tags];\n    newTags.splice(i, 1);\n    console.log(newTags);\n    setTags([...newTags]);\n  };\n\n  const InputKeyDown = (e) => {\n    const val = e.target.value;\n    if (e.key === \"Enter\" && val) {\n      if (tags.length === 3) {\n        alert(\"태그는 최대 3개까지 가능합니다.\");\n        return;\n      }\n      if (tags.find((tag) => tag.toLowerCase() === val.toLowerCase())) {\n        return;\n      }\n      setTags([...tags, val]);\n      tagInput.current.value = null;\n    } else if (e.key === \"Backspace\" && !val) {\n      removeTag(tags.length - 1);\n    }\n  };\n\n  const closeModal = () => {\n    dispatch(CLOSE_MODAL());\n  };\n\n  const params = {\n    src: info.information.videoUrl,\n  };\n\n  useEffect(() => {\n    if (hls === undefined) {\n      return;\n    }\n    if (Hls.isSupported()) {\n      hls.attachMedia(player.current);\n      hls.config.debug = false;\n\n      hls.on(Hls.Events.MEDIA_ATTACHED, (event, data) => {\n        hls.loadSource(params.src);\n      });\n      hls.on(Hls.Events.ERROR, (event, data) => {\n        if (data.fatal) {\n          switch (data.type) {\n            case Hls.ErrorTypes.NETWORK_ERROR:\n              console.log(\"네트워크 오류\");\n              hls.startLoad();\n              break;\n            case Hls.ErrorTypes.MEDIA_ERROR:\n              console.log(\"미디어 오류\");\n              hls.recoverMediaError();\n              break;\n            default:\n              hls.destroy();\n              break;\n          }\n        }\n      });\n\n      return () => hls.destroy();\n    } else if (player.current.canPlayType(\"application/vnd.apple.mpegurl\")) {\n      player.current.src = params.src;\n      player.current.addEventListener(\"loadedmetadata\", () => {\n        player.current.play();\n      });\n    }\n  }, []);\n\n  const videoplay = () => {\n    if (player.current.readyState !== 4) {\n      return;\n    }\n    player.current.play();\n  };\n\n  const videopause = () => {\n    if (player.current.readyState !== 4) {\n      return;\n    }\n    player.current.pause();\n  };\n\n  const like = () => {\n    const access_token = localStorage.getItem(\"access_token\");\n    if (!access_token) {\n      Swal.fire({\n        title: \"로그인을 해주세요.\",\n        text: \"로그인 후 좋아요를 누를 수 있습니다.\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#3085d6\",\n        cancelButtonColor: \"#d33\",\n        confirmButtonText: \"로그인하기\",\n        cancelButtonText: \"닫기\",\n      }).then((result) => {\n        if (result.isConfirmed) {\n          history.push(\"/login\");\n        }\n      });\n    }\n    dispatch(TrilsActions.send_like(info.information.id, info.member.isLike));\n  };\n\n  const del = () => {\n    Swal.fire({\n      title: \"게시글을 삭제하시겠습니까?\",\n      text: \"게시글 삭제 시 다시 복구할 수 없습니다.\",\n      icon: \"warning\",\n      showCancelButton: true,\n      confirmButtonColor: \"#3085d6\",\n      cancelButtonColor: \"#d33\",\n      confirmButtonText: \"삭제\",\n      cancelButtonText: \"취소\",\n    }).then((result) => {\n      if (result.isConfirmed) {\n        const access_token = localStorage.getItem(\"access_token\");\n        const url = `${config}/api/posts/${info.information.id}`;\n        const data = {\n          method: \"DELETE\",\n          headers: {\n            Authorization: `${access_token}`,\n          },\n        };\n        fetch(url, data)\n          .then((result) => {\n            return result.json();\n          })\n          .then((result) => {\n            if (result.ok) {\n              dispatch(DELETE_POST(info.information.id));\n              Swal.fire(\n                \"삭제 완료!\",\n                \"게시글이 삭제되었습니다.\",\n                \"success\"\n              ).then(() => {\n                closeModal();\n              });\n            }\n          })\n          .catch((err) => console.log(err));\n      }\n    });\n  };\n\n  const hash = (e) => {\n    history.push(`/search?q=${e.target.id}&filter=likeNum`, 1);\n    closeModal();\n  };\n\n  const edit = () => {\n    setEditOn(true);\n  };\n\n  const cancelEdit = () => {\n    setEditOn(false);\n  };\n\n  const doEdit = () => {\n    const access_token = localStorage.getItem(\"access_token\");\n    const url = `${config}/api/posts/${info.information.id}`;\n    const data = {\n      method: \"PUT\",\n      headers: {\n        Authorization: `${access_token}`,\n      },\n      body: {\n        hashtag: tags,\n      },\n    };\n    fetch(url, data)\n      .then((result) => {\n        return result.json();\n      })\n      .then((result) => {\n        if (result.ok) {\n          console.log(result);\n        }\n      })\n      .catch((err) => console.log(err));\n  };\n\n  return (\n    <React.Fragment>\n      <Component onClick={closeModal} />\n      <Wrap>\n        <Profile>\n          <ProfileImg src={info.author.profileImgUrl} />\n          <ProfileId>{info.author.nickname}</ProfileId>\n        </Profile>\n        <View onMouseOver={videoplay} onMouseLeave={videopause}>\n          <VideoPlay\n            ref={player}\n            muted\n            loop\n            onTimeUpdate={() => {\n              setCompleted(\n                (player.current.currentTime / player.current.duration) * 100\n              );\n              setProgress(player.current.clientWidth);\n            }}\n          />\n        </View>\n        <Progress width={progress}>\n          <ProgressBar bgcolor={\"#6a1b9a\"} completed={completed} />\n        </Progress>\n        <LowWrap>\n          <LikeCov onClick={like}>\n            {info.member.isLike ? <HeartFill /> : <HeartEmpty />}\n          </LikeCov>\n          <p style={{ color: \"#8B8888\", width: \"5rem\" }}>\n            좋아요 +{info.information.likeNum}\n          </p>\n          <Tag>\n            {editOn ? (\n              <>\n                {tags.map((tag, i) => (\n                  <Li key={tag}>\n                    #{tag}\n                    <Libutton\n                      type=\"button\"\n                      onClick={() => {\n                        removeTag(i);\n                      }}\n                    >\n                      <IconCover>\n                        <ClearIcon />\n                      </IconCover>\n                    </Libutton>\n                  </Li>\n                ))}\n              </>\n            ) : (\n              <>\n                {info.information.hashtag.map((p, idx) => {\n                  return (\n                    <>\n                      <Hash id={p} onClick={hash}>\n                        #{p}\n                      </Hash>\n                    </>\n                  );\n                })}\n              </>\n            )}\n          </Tag>\n        </LowWrap>\n        {editOn ? (\n          <InputTag>\n            <Input\n              type=\"text\"\n              onKeyDown={InputKeyDown}\n              ref={tagInput}\n              placeholder=\"# 자유롭게 적고 엔터를 눌러주세요.\"\n            ></Input>\n          </InputTag>\n        ) : (\n          <></>\n        )}\n        <Bottom>\n          {editOn ? (\n            <>\n              <Edit onClick={doEdit}>수정완료</Edit>\n              <Delete onClick={cancelEdit}>수정취소</Delete>\n            </>\n          ) : (\n            <>\n              {info.member.isMembers ? (\n                <>\n                  <Edit onClick={edit}>수정하기</Edit>\n                  <Delete onClick={del}>삭제하기</Delete>\n                </>\n              ) : (\n                <></>\n              )}\n            </>\n          )}\n          <Close onClick={closeModal}>닫기</Close>\n        </Bottom>\n      </Wrap>\n    </React.Fragment>\n  );\n};\n\nconst Input = styled.input`\n  outline: none;\n  width: 100%;\n  height: 2.5rem;\n  border: 0;\n  border-radius: 5px;\n  display: flex;\n  justify-content: flex-start;\n  /* margin: 0px auto; */\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  font-size: 1rem;\n`;\n\nconst InputTag = styled.div`\n  min-width: 30rem;\n  width: 100%;\n  height: 100%;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  display: inline-flex;\n  flex-wrap: wrap;\n  justify-content: flex-start;\n  margin: 0px auto;\n  padding: 5px;\n  margin-bottom: 1rem;\n`;\n\nconst IconCover = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  & svg {\n    width: 1rem;\n  }\n`;\n\nconst Libutton = styled.div`\n  display: inline-flex;\n  align-items: center;\n  appearance: none;\n  background: #333333;\n  border: none;\n  border-radius: 50%;\n  color: white;\n  cursor: pointer;\n  font-size: 12px;\n  height: 15px;\n  justify-content: center;\n  line-height: 0;\n  margin-left: 8px;\n  padding: 0;\n  width: 15px;\n  outline: 0;\n`;\n\nconst Li = styled.p`\n  cursor: pointer;\n  margin-left: 0.5rem;\n  margin-right: 1rem;\n  font-family: \"AppleSDGothicNeoR\";\n  color: blue;\n  display: flex;\n  align-items: center;\n`;\n\nconst Bottom = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n`;\n\nconst Edit = styled.button`\n  cursor: pointer;\n  font-family: \"TTTogether\";\n  font-size: 1rem;\n  color: #ffffff;\n  background-color: #2b61e1;\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  width: 8rem;\n  height: 3rem;\n`;\n\nconst Delete = styled.button`\n  cursor: pointer;\n  font-family: \"TTTogether\";\n  font-size: 1rem;\n  color: #ffffff;\n  background-color: #2b61e1;\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  width: 8rem;\n  height: 3rem;\n  margin-left: 1rem;\n`;\n\nconst Close = styled.button`\n  cursor: pointer;\n  font-family: \"TTTogether\";\n  font-size: 1rem;\n  color: #ffffff;\n  background-color: #2b61e1;\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  width: 8rem;\n  height: 3rem;\n  margin-left: 1rem;\n`;\n\nconst Progress = styled.div`\n  margin: 0 auto;\n  width: ${(props) => props.width}px;\n`;\n\nconst VideoPlay = styled.video`\n  display: flex;\n  margin: 0 auto;\n  max-width: 50rem;\n  max-height: 21.5rem;\n  /* object-fit: cover; */\n`;\n\nconst VideoBg = styled.div`\n  display: flex;\n  height: 25rem;\n  width: 25rem;\n  border-radius: 20px;\n  background: beige;\n  margin-top: -25rem;\n  z-index: -99;\n`;\n\nconst Hash = styled.div`\n  cursor: pointer;\n  margin-left: 0.5rem;\n  font-family: \"AppleSDGothicNeoR\";\n  color: blue;\n  transition: 0.5s ease-in-out;\n  :hover {\n    transform: scale(1.2);\n  }\n`;\n\nconst Component = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  height: 100vh;\n  width: 100vw;\n  background-color: black;\n  z-index: 10;\n  opacity: 0.4;\n`;\nconst Wrap = styled.div`\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 20;\n  background-color: white;\n  max-width: 57rem;\n  max-height: 37rem;\n  display: flex;\n  flex-direction: column;\n  /* justify-content: center;\n  align-items: center; */\n  margin: 0px auto;\n  box-shadow: 0px 3px 6px #00000029;\n  border: 1px solid #2b61e1;\n  border-radius: 5px;\n  padding: 3rem;\n  z-index: 98;\n`;\n\nconst LowWrap = styled.div`\n  display: flex;\n  flex-direction: row;\n  margin-left: 1rem;\n  margin-top: 1rem;\n  margin-bottom: 2rem;\n`;\n\nconst Profile = styled.div`\n  display: flex;\n  height: 3rem;\n  align-items: center;\n  margin-bottom: 1rem;\n`;\n\nconst ProfileImg = styled.div`\n  --size: 38px;\n  width: var(--size);\n  height: var(--size);\n  border-radius: var(--size);\n  background-position: center;\n  background-image: url(${(props) => props.src});\n  background-size: cover;\n  margin-left: 16px;\n  display: flex;\n`;\n\nconst ProfileId = styled.div`\n  display: flex;\n  font-weight: 600;\n  font-size: 1rem;\n  margin-left: 11px;\n  align-items: center;\n`;\n\nconst View = styled.div`\n  max-width: 50rem;\n  max-height: 21.5rem;\n  width: auto;\n  height: auto;\n  background-color: #ededed;\n  /* background-color: #ededed; */\n  display: flex;\n  justify-content: center;\n  margin: 0px auto;\n`;\n\nconst LikeCov = styled.div`\n  margin-right: 1rem;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  z-index: 10;\n  & svg {\n    width: 1.5rem;\n  }\n`;\n\nconst Tag = styled.p`\n  font-weight: 700;\n  margin-left: 1rem;\n  display: flex;\n  flex-direction: row;\n`;\n\nexport default TrilsDetail;\n"]},"metadata":{},"sourceType":"module"}