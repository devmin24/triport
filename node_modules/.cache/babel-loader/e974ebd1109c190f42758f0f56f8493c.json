{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/parkminkyung/Desktop/git/triport/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _slicedToArray from\"/Users/parkminkyung/Desktop/git/triport/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12;import React,{useRef,useState,useEffect,Fragment}from\"react\";import styled from\"styled-components\";import Hls from\"hls.js\";import ProgressBar from\"./ProgressBar\";import{HeartEmpty,HeartFill}from\"media/svg/Svg\";import{useDispatch}from\"react-redux\";import{TrilsActions}from\"redux/modules/trils\";import Uploadex from\"../../media/image/upload_ex.png\";import Swal from\"sweetalert2\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Video=function Video(props){var mr=props.mr,history=props.history;var player=useRef(null);var players=useRef(null);var _useState=useState(0),_useState2=_slicedToArray(_useState,2),completed=_useState2[0],setCompleted=_useState2[1];var dispatch=useDispatch();var check=navigator.userAgent.toLowerCase();var is_iphone=check.indexOf(\"iphone\")!==-1;var params={src:props.information.videoUrl};useEffect(function(){if(is_iphone){return;}var hls=new Hls();if(hls===undefined){return;}if(Hls.isSupported()){hls.attachMedia(player.current);hls.config.debug=false;hls.on(Hls.Events.MEDIA_ATTACHED,function(event,data){hls.loadSource(params.src);});hls.on(Hls.Events.ERROR,function(event,data){if(data.fatal){switch(data.type){case Hls.ErrorTypes.NETWORK_ERROR:console.log(\"네트워크 오류\");hls.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.log(\"미디어 오류\");hls.recoverMediaError();break;default:hls.destroy();break;}}});return function(){return hls.destroy();};}else if(player.current.canPlayType(\"application/vnd.apple.mpegurl\")){player.current.src=params.src;player.current.addEventListener(\"loadedmetadata\",function(){player.current.play();});}},[params.src]);var hlsplay=function hlsplay(){if(player.current.readyState!==4){return;}player.current.play();};var hlspause=function hlspause(){if(player.current.readyState!==4){return;}player.current.pause();};var mp4play=function mp4play(){if(players.current.readyState!==4){return;}players.current.play();};var mp4pause=function mp4pause(){if(players.current.readyState!==4){return;}players.current.pause();};var openModal=function openModal(){if(window.innerWidth>1024){dispatch(TrilsActions.getPostDetail(props.information.id));}else{dispatch(TrilsActions.getPostDetail(props.information.id,false));history.push(\"/trils/detail/\".concat(props.information.id));}};var like=function like(e){e.stopPropagation();var access_token=localStorage.getItem(\"access_token\");if(!access_token){Swal.fire({title:\"로그인을 해주세요.\",text:\"로그인 후 좋아요를 누를 수 있습니다.\",icon:\"warning\",showCancelButton:true,confirmButtonColor:\"#3085d6\",cancelButtonColor:\"#d33\",confirmButtonText:\"로그인하기\",cancelButtonText:\"닫기\"}).then(function(result){if(result.isConfirmed){history.push(\"/login\");}});}else{dispatch(TrilsActions.send_like(props.information.id,props.member.isLike));}};return/*#__PURE__*/_jsxs(VideoCards,{margin:mr,onClick:openModal,children:[/*#__PURE__*/_jsxs(Profile,{children:[/*#__PURE__*/_jsx(ProfileImg,{src:props.author.profileImgUrl}),/*#__PURE__*/_jsx(ProfileId,{children:props.author.nickname})]}),is_iphone?/*#__PURE__*/_jsx(VideoPlay,{src:params.src,loop:true,autoPlay:true,muted:true,playsInline:true}):/*#__PURE__*/_jsx(_Fragment,{children:props.information.posPlay?/*#__PURE__*/_jsx(_Fragment,{children:props.information.videoType===\"mp4\"||props.information.videoType===\"mov\"?/*#__PURE__*/_jsx(_Fragment,{children:window.innerWidth>1024?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(VideoPlay,{onMouseOver:mp4play,onMouseLeave:mp4pause,ref:players,src:params.src,muted:true,loop:true,onTimeUpdate:function onTimeUpdate(){setCompleted(players.current.currentTime/players.current.duration*100);}})}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(VideoPlay,{ref:players,src:params.src,muted:true,loop:true,onTimeUpdate:function onTimeUpdate(){setCompleted(players.current.currentTime/players.current.duration*100);}})})}):/*#__PURE__*/_jsx(_Fragment,{children:window.innerWidth>1024?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(VideoPlay,{onMouseOver:hlsplay,onMouseLeave:hlspause,ref:player,muted:true,loop:true,onTimeUpdate:function onTimeUpdate(){setCompleted(player.current.currentTime/player.current.duration*100);}})}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(VideoPlay,{ref:player,muted:true,loop:true,onTimeUpdate:function onTimeUpdate(){setCompleted(player.current.currentTime/player.current.duration*100);}})})})}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Uploading,{src:Uploadex})})}),/*#__PURE__*/_jsx(ProgressBar,{bgcolor:\"#6a1b9a\",completed:completed}),/*#__PURE__*/_jsxs(PostBottom,{children:[/*#__PURE__*/_jsx(BottomCov,{children:/*#__PURE__*/_jsx(LikeCov,{onClick:like,children:props.member.isLike?/*#__PURE__*/_jsx(HeartFill,{}):/*#__PURE__*/_jsx(HeartEmpty,{})})}),/*#__PURE__*/_jsxs(PostLikeCnt,{children:[\"\\uC88B\\uC544\\uC694 +\",props.information.likeNum]}),/*#__PURE__*/_jsx(PostUserComment,{children:props.information.hashtag.map(function(p,idx){return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsxs(Hash,{children:[\"#\",p]})},idx);})})]})]});};var Uploading=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  height: 45rem;\\n  width: 25rem;\\n  margin: 0 auto;\\n  background-image: url(\\\"\",\"\\\");\\n  background-size: contain;\\n  @media only screen and (max-width: 420px) {\\n    width: 100%;\\n  }\\n\"])),function(props){return props.src;});var Hash=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin-left: 0.5rem;\\n  font-family: \\\"AppleSDGothicNeoR\\\";\\n  color: blue;\\n\"])));var PostBottom=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  margin-top: 1rem;\\n  margin-left: 10px;\\n  display: flex;\\n  flex-direction: row;\\n  margin-bottom: 0.5rem;\\n  flex-wrap: wrap;\\n\"])));var PostLikeCnt=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  font-family: \\\"AppleSDGothicNeoR\\\";\\n  display: flex;\\n  user-select: none;\\n\"])));var PostUserComment=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  font-family: \\\"AppleSDGothicNeoR\\\";\\n  display: flex;\\n  margin-left: 18px;\\n  cursor: pointer;\\n\"])));var VideoCards=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  display: flex;\\n  max-width: 25rem;\\n  flex-direction: column;\\n  margin-bottom: 1.5rem;\\n  \",\";\\n  margin-top: 1rem;\\n  transition: 0.5s ease-in-out;\\n  @media only screen and (min-width: 1024px) {\\n    :hover {\\n      transform: scale(1.03);\\n    }\\n  }\\n  box-shadow: 0px 3px 6px #00000029;\\n\"])),function(props){return props.margin?\"margin-right:2.5rem\":\"\";});var VideoPlay=styled.video(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  display: flex;\\n  height: 45rem;\\n  width: 25rem;\\n  margin: 0 auto;\\n  object-fit: cover;\\n  @media only screen and (max-width: 420px) {\\n    width: 100%;\\n  }\\n\"])));var Profile=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  user-select: none;\\n  position: absolute;\\n  padding-top: 0.7rem;\\n  display: flex;\\n  z-index: 5;\\n\"])));var ProfileImg=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  --size: 38px;\\n  width: var(--size);\\n  height: var(--size);\\n  border-radius: var(--size);\\n  background-position: center;\\n  background-image: url(\",\");\\n  background-color: white;\\n  background-size: cover;\\n  margin-left: 16px;\\n  display: flex;\\n\"])),function(props){return props.src;});var ProfileId=styled.div(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  display: flex;\\n  font-weight: 600;\\n  font-size: 1rem;\\n  margin-left: 11px;\\n  align-items: center;\\n  /* background:white; */\\n  border-radius: 20px;\\n  width: 100px;\\n  color: white;\\n  text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;\\n\"])));var LikeCov=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  z-index: 10;\\n  & svg {\\n    width: 1.5rem;\\n  }\\n\"])));var BottomCov=styled.div(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  display: flex;\\n  margin-right: 0.7rem;\\n\"])));export default Video;","map":{"version":3,"sources":["/Users/parkminkyung/Desktop/git/triport/src/components/trils/Video.js"],"names":["React","useRef","useState","useEffect","Fragment","styled","Hls","ProgressBar","HeartEmpty","HeartFill","useDispatch","TrilsActions","Uploadex","Swal","Video","props","mr","history","player","players","completed","setCompleted","dispatch","check","navigator","userAgent","toLowerCase","is_iphone","indexOf","params","src","information","videoUrl","hls","undefined","isSupported","attachMedia","current","config","debug","on","Events","MEDIA_ATTACHED","event","data","loadSource","ERROR","fatal","type","ErrorTypes","NETWORK_ERROR","console","log","startLoad","MEDIA_ERROR","recoverMediaError","destroy","canPlayType","addEventListener","play","hlsplay","readyState","hlspause","pause","mp4play","mp4pause","openModal","window","innerWidth","getPostDetail","id","push","like","e","stopPropagation","access_token","localStorage","getItem","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","then","result","isConfirmed","send_like","member","isLike","author","profileImgUrl","nickname","posPlay","videoType","currentTime","duration","likeNum","hashtag","map","p","idx","Uploading","div","Hash","PostBottom","PostLikeCnt","PostUserComment","VideoCards","margin","VideoPlay","video","Profile","ProfileImg","ProfileId","LikeCov","BottomCov"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect, Fragment } from \"react\";\nimport styled from \"styled-components\";\nimport Hls from \"hls.js\";\nimport ProgressBar from \"./ProgressBar\";\nimport { HeartEmpty, HeartFill } from \"media/svg/Svg\";\nimport { useDispatch } from \"react-redux\";\nimport { TrilsActions } from \"redux/modules/trils\";\nimport Uploadex from \"../../media/image/upload_ex.png\";\nimport Swal from \"sweetalert2\";\n\nconst Video = (props) => {\n  const { mr, history } = props;\n  const player = useRef(null);\n  const players = useRef(null);\n  const [completed, setCompleted] = useState(0);\n  const dispatch = useDispatch();\n  const check = navigator.userAgent.toLowerCase();\n  const is_iphone = check.indexOf(\"iphone\") !== -1;\n\n  const params = {\n    src: props.information.videoUrl,\n  };\n\n  useEffect(() => {\n    if (is_iphone) {\n      return;\n    }\n    const hls = new Hls();\n    if (hls === undefined) {\n      return;\n    }\n    if (Hls.isSupported()) {\n      hls.attachMedia(player.current);\n      hls.config.debug = false;\n\n      hls.on(Hls.Events.MEDIA_ATTACHED, (event, data) => {\n        hls.loadSource(params.src);\n      });\n      hls.on(Hls.Events.ERROR, (event, data) => {\n        if (data.fatal) {\n          switch (data.type) {\n            case Hls.ErrorTypes.NETWORK_ERROR:\n              console.log(\"네트워크 오류\");\n              hls.startLoad();\n              break;\n            case Hls.ErrorTypes.MEDIA_ERROR:\n              console.log(\"미디어 오류\");\n              hls.recoverMediaError();\n              break;\n            default:\n              hls.destroy();\n              break;\n          }\n        }\n      });\n      return () => hls.destroy();\n    } else if (player.current.canPlayType(\"application/vnd.apple.mpegurl\")) {\n      player.current.src = params.src;\n      player.current.addEventListener(\"loadedmetadata\", () => {\n        player.current.play();\n      });\n    }\n  }, [params.src]);\n\n  const hlsplay = () => {\n    if (player.current.readyState !== 4) {\n      return;\n    }\n    player.current.play();\n  };\n\n  const hlspause = () => {\n    if (player.current.readyState !== 4) {\n      return;\n    }\n    player.current.pause();\n  };\n\n  const mp4play = () => {\n    if (players.current.readyState !== 4) {\n      return;\n    }\n    players.current.play();\n  };\n\n  const mp4pause = () => {\n    if (players.current.readyState !== 4) {\n      return;\n    }\n    players.current.pause();\n  };\n\n  const openModal = () => {\n    if (window.innerWidth > 1024) {\n      dispatch(TrilsActions.getPostDetail(props.information.id));\n    } else {\n      dispatch(TrilsActions.getPostDetail(props.information.id, false));\n      history.push(`/trils/detail/${props.information.id}`);\n    }\n  };\n\n  const like = (e) => {\n    e.stopPropagation();\n    const access_token = localStorage.getItem(\"access_token\");\n    if (!access_token) {\n      Swal.fire({\n        title: \"로그인을 해주세요.\",\n        text: \"로그인 후 좋아요를 누를 수 있습니다.\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#3085d6\",\n        cancelButtonColor: \"#d33\",\n        confirmButtonText: \"로그인하기\",\n        cancelButtonText: \"닫기\",\n      }).then((result) => {\n        if (result.isConfirmed) {\n          history.push(\"/login\");\n        }\n      });\n    } else {\n      dispatch(\n        TrilsActions.send_like(props.information.id, props.member.isLike)\n      );\n    }\n  };\n\n  return (\n    <VideoCards margin={mr} onClick={openModal}>\n      <Profile>\n        <ProfileImg src={props.author.profileImgUrl} />\n        <ProfileId>{props.author.nickname}</ProfileId>\n      </Profile>\n      {is_iphone ? (\n        <VideoPlay src={params.src} loop autoPlay muted playsInline />\n      ) : (\n        <>\n          {props.information.posPlay ? (\n            <>\n              {props.information.videoType === \"mp4\" ||\n              props.information.videoType === \"mov\" ? (\n                <>\n                  {window.innerWidth > 1024 ? (\n                    <>\n                      <VideoPlay\n                        onMouseOver={mp4play}\n                        onMouseLeave={mp4pause}\n                        ref={players}\n                        src={params.src}\n                        muted\n                        loop\n                        onTimeUpdate={() => {\n                          setCompleted(\n                            (players.current.currentTime /\n                              players.current.duration) *\n                              100\n                          );\n                        }}\n                      />\n                    </>\n                  ) : (\n                    <>\n                      <VideoPlay\n                        ref={players}\n                        src={params.src}\n                        muted\n                        loop\n                        onTimeUpdate={() => {\n                          setCompleted(\n                            (players.current.currentTime /\n                              players.current.duration) *\n                              100\n                          );\n                        }}\n                      />\n                    </>\n                  )}\n                </>\n              ) : (\n                <>\n                  {window.innerWidth > 1024 ? (\n                    <>\n                      <VideoPlay\n                        onMouseOver={hlsplay}\n                        onMouseLeave={hlspause}\n                        ref={player}\n                        muted\n                        loop\n                        onTimeUpdate={() => {\n                          setCompleted(\n                            (player.current.currentTime /\n                              player.current.duration) *\n                              100\n                          );\n                        }}\n                      />\n                    </>\n                  ) : (\n                    <>\n                      <VideoPlay\n                        ref={player}\n                        muted\n                        loop\n                        onTimeUpdate={() => {\n                          setCompleted(\n                            (player.current.currentTime /\n                              player.current.duration) *\n                              100\n                          );\n                        }}\n                      />\n                    </>\n                  )}\n                </>\n              )}\n            </>\n          ) : (\n            <>\n              <Uploading src={Uploadex} />\n            </>\n          )}\n        </>\n      )}\n      <ProgressBar bgcolor={\"#6a1b9a\"} completed={completed} />\n      <PostBottom>\n        <BottomCov>\n          <LikeCov onClick={like}>\n            {props.member.isLike ? <HeartFill /> : <HeartEmpty />}\n          </LikeCov>\n        </BottomCov>\n        <PostLikeCnt>좋아요 +{props.information.likeNum}</PostLikeCnt>\n        <PostUserComment>\n          {props.information.hashtag.map((p, idx) => {\n            return (\n              <Fragment key={idx}>\n                <Hash>#{p}</Hash>\n              </Fragment>\n            );\n          })}\n        </PostUserComment>\n      </PostBottom>\n    </VideoCards>\n  );\n};\n\nconst Uploading = styled.div`\n  display: flex;\n  height: 45rem;\n  width: 25rem;\n  margin: 0 auto;\n  background-image: url(\"${(props) => props.src}\");\n  background-size: contain;\n  @media only screen and (max-width: 420px) {\n    width: 100%;\n  }\n`;\n\nconst Hash = styled.div`\n  margin-left: 0.5rem;\n  font-family: \"AppleSDGothicNeoR\";\n  color: blue;\n`;\n\nconst PostBottom = styled.div`\n  margin-top: 1rem;\n  margin-left: 10px;\n  display: flex;\n  flex-direction: row;\n  margin-bottom: 0.5rem;\n  flex-wrap: wrap;\n`;\n\nconst PostLikeCnt = styled.div`\n  font-family: \"AppleSDGothicNeoR\";\n  display: flex;\n  user-select: none;\n`;\n\nconst PostUserComment = styled.div`\n  font-family: \"AppleSDGothicNeoR\";\n  display: flex;\n  margin-left: 18px;\n  cursor: pointer;\n`;\n\nconst VideoCards = styled.div`\n  display: flex;\n  max-width: 25rem;\n  flex-direction: column;\n  margin-bottom: 1.5rem;\n  ${(props) => (props.margin ? \"margin-right:2.5rem\" : \"\")};\n  margin-top: 1rem;\n  transition: 0.5s ease-in-out;\n  @media only screen and (min-width: 1024px) {\n    :hover {\n      transform: scale(1.03);\n    }\n  }\n  box-shadow: 0px 3px 6px #00000029;\n`;\n\nconst VideoPlay = styled.video`\n  display: flex;\n  height: 45rem;\n  width: 25rem;\n  margin: 0 auto;\n  object-fit: cover;\n  @media only screen and (max-width: 420px) {\n    width: 100%;\n  }\n`;\n\nconst Profile = styled.div`\n  user-select: none;\n  position: absolute;\n  padding-top: 0.7rem;\n  display: flex;\n  z-index: 5;\n`;\n\nconst ProfileImg = styled.div`\n  --size: 38px;\n  width: var(--size);\n  height: var(--size);\n  border-radius: var(--size);\n  background-position: center;\n  background-image: url(${(props) => props.src});\n  background-color: white;\n  background-size: cover;\n  margin-left: 16px;\n  display: flex;\n`;\n\nconst ProfileId = styled.div`\n  display: flex;\n  font-weight: 600;\n  font-size: 1rem;\n  margin-left: 11px;\n  align-items: center;\n  /* background:white; */\n  border-radius: 20px;\n  width: 100px;\n  color: white;\n  text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;\n`;\n\nconst LikeCov = styled.div`\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  z-index: 10;\n  & svg {\n    width: 1.5rem;\n  }\n`;\nconst BottomCov = styled.div`\n  display: flex;\n  margin-right: 0.7rem;\n`;\n\nexport default Video;"]},"metadata":{},"sourceType":"module"}